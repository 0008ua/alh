(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{nhAk:function(e,o,n){"use strict";n.r(o),n.d(o,"ManagementPageModule",function(){return $});var t=n("ofXK"),i=n("3Pt+"),b=n("TEn/"),s=n("tyNb"),c=n("mrSG"),l=n("IjAw"),r=n("zHMj"),a=n("EhJz"),d=n("dndX"),m=n("PQ5l"),g=n("lJxs"),M=n("tJKL"),u=n("4dfA"),h=n("mgGq"),p=n("fXoL"),f=n("mrZj"),N=n("l7P3"),k=n("sYmb");function y(e,o){if(1&e){const e=p.Ob();p.Nb(0,"ion-datetime",13),p.Vb("ngModelChange",function(o){return p.kc(e),p.Xb().date=o})("ionChange",function(){return p.kc(e),p.Xb().filter()}),p.Mb()}if(2&e){const e=p.Xb();p.ec("monthNames",e.monthNames),p.dc("max",e.maxDate)("ngModel",e.date)}}function O(e,o){if(1&e&&(p.Nb(0,"ion-select-option",16),p.oc(1),p.Yb(2,"translate"),p.Mb()),2&e){const e=o.$implicit;p.dc("value",e),p.yb(1),p.qc(" ",p.Zb(2,2,"common.sortFields."+e)," ")}}function S(e,o){if(1&e){const e=p.Ob();p.Nb(0,"ion-select",14),p.Vb("ngModelChange",function(o){return p.kc(e),p.Xb().sortField=o})("ionChange",function(){return p.kc(e),p.Xb().filter()}),p.nc(1,O,3,4,"ion-select-option",15),p.Mb()}if(2&e){const e=p.Xb();p.dc("ngModel",e.sortField),p.yb(1),p.dc("ngForOf",e.sortFields)}}function w(e,o){if(1&e&&(p.Nb(0,"ion-select-option",16),p.oc(1),p.Yb(2,"translate"),p.Mb()),2&e){const e=o.$implicit;p.dc("value",e),p.yb(1),p.qc(" ",p.Zb(2,2,"common.sortOrders."+e)," ")}}function Y(e,o){if(1&e){const e=p.Ob();p.Nb(0,"ion-select",14),p.Vb("ngModelChange",function(o){return p.kc(e),p.Xb().sortOrder=o})("ionChange",function(){return p.kc(e),p.Xb().filter()}),p.nc(1,w,3,4,"ion-select-option",15),p.Mb()}if(2&e){const e=p.Xb();p.dc("ngModel",e.sortOrder),p.yb(1),p.dc("ngForOf",e.sortOrders)}}function C(e,o){if(1&e&&(p.Nb(0,"ion-select-option",16),p.oc(1),p.Mb()),2&e){const e=o.$implicit;p.dc("value",e),p.yb(1),p.qc("",e.name," ")}}function v(e,o){if(1&e){const e=p.Ob();p.Nb(0,"ion-select",14),p.Vb("ngModelChange",function(o){return p.kc(e),p.Xb().room=o})("ionChange",function(){return p.kc(e),p.Xb().filter()}),p.nc(1,C,2,2,"ion-select-option",15),p.Mb()}if(2&e){const e=p.Xb();p.dc("ngModel",e.room),p.yb(1),p.dc("ngForOf",e.rooms)}}function F(e,o){if(1&e&&(p.Nb(0,"ion-select-option",16),p.oc(1),p.Yb(2,"translate"),p.Mb()),2&e){const e=o.$implicit;p.dc("value",e),p.yb(1),p.qc(" ",p.Zb(2,2,"common.bookingSteps."+e)," ")}}function X(e,o){if(1&e){const e=p.Ob();p.Nb(0,"ion-select",14),p.Vb("ngModelChange",function(o){return p.kc(e),p.Xb().bookingStep=o})("ionChange",function(){return p.kc(e),p.Xb().filter()}),p.nc(1,F,3,4,"ion-select-option",15),p.Mb()}if(2&e){const e=p.Xb();p.dc("ngModel",e.bookingStep),p.yb(1),p.dc("ngForOf",e.bookingSteps)}}function x(e,o){if(1&e&&(p.Nb(0,"ion-select-option",16),p.oc(1),p.Yb(2,"translate"),p.Mb()),2&e){const e=o.$implicit;p.dc("value",e),p.yb(1),p.qc(" ",p.Zb(2,2,"common.bookingStepExprs."+e)," ")}}function I(e,o){if(1&e){const e=p.Ob();p.Nb(0,"ion-select",17),p.Vb("ngModelChange",function(o){return p.kc(e),p.Xb().bookingStepExpr=o})("ionChange",function(){return p.kc(e),p.Xb().filter()}),p.nc(1,x,3,4,"ion-select-option",15),p.Mb()}if(2&e){const e=p.Xb();p.dc("ngModel",e.bookingStepExpr)("disabled",!e.bookingStep),p.yb(1),p.dc("ngForOf",e.bookingStepExprs)}}function D(e,o){if(1&e){const e=p.Ob();p.Nb(0,"ion-item-options",22),p.Nb(1,"ion-item-option",23),p.Vb("click",function(){p.kc(e);const o=p.Xb().$implicit;return p.Xb().presentAlert(o._id)}),p.Jb(2,"ion-icon",24),p.Mb(),p.Mb()}}function Z(e,o){if(1&e){const e=p.Ob();p.Nb(0,"ion-item-options",25),p.Nb(1,"ion-item-option",26),p.Vb("click",function(){p.kc(e);const o=p.Xb().$implicit;return p.Xb().update(o._id)}),p.Jb(2,"ion-icon",27),p.Mb(),p.Mb()}}function q(e,o){if(1&e){const e=p.Ob();p.Lb(0),p.Nb(1,"ion-item-sliding"),p.Nb(2,"ion-item",18),p.Nb(3,"ion-label"),p.Nb(4,"ion-row"),p.Nb(5,"ion-col",8),p.Nb(6,"ion-item",9),p.Nb(7,"ion-label",10),p.Nb(8,"ion-button",19),p.Vb("click",function(){p.kc(e);const n=o.$implicit;return p.Xb().viewBooking(n._id)}),p.oc(9),p.Yb(10,"translate"),p.Mb(),p.Mb(),p.Mb(),p.Mb(),p.Nb(11,"ion-col",8),p.Nb(12,"ion-item",9),p.Nb(13,"ion-label",10),p.oc(14),p.Yb(15,"date"),p.Mb(),p.Mb(),p.Mb(),p.Nb(16,"ion-col",8),p.Nb(17,"ion-item",9),p.Nb(18,"ion-label",10),p.oc(19),p.Yb(20,"date"),p.Mb(),p.Mb(),p.Mb(),p.Nb(21,"ion-col",8),p.Nb(22,"ion-item",9),p.Nb(23,"ion-label",10),p.Nb(24,"ion-text",11),p.oc(25),p.Mb(),p.Mb(),p.Mb(),p.Mb(),p.Mb(),p.Mb(),p.Mb(),p.nc(26,D,3,0,"ion-item-options",20),p.nc(27,Z,3,0,"ion-item-options",21),p.Mb(),p.Kb()}if(2&e){const e=o.$implicit,n=p.Xb();p.yb(8),p.dc("ngClass","status-color_"+e.bookingStep),p.yb(1),p.pc(p.Zb(10,7,"common.bookingSteps."+e.bookingStep)),p.yb(5),p.qc(" ",p.ac(15,9,e.dates.from,"dd MMM")," "),p.yb(5),p.qc(" ",p.ac(20,12,e.dates.to,"dd MMM")," "),p.yb(6),p.qc(" ",e.price," "),p.yb(1),p.dc("ngIf",!(null!=n.user&&n.user.blocked)),p.yb(1),p.dc("ngIf","cancelled"!==e.bookingStep&&!(null!=n.user&&n.user.blocked))}}const j=[{path:"",component:(()=>{class e{constructor(e,o,n,t,i,b){this.sheduleService=e,this.store=o,this.router=n,this.route=t,this.alertController=i,this.translate=b,this.bookingSteps=m.b,this.bookingStep="cancelled",this.bookingStepExprs=m.a,this.bookingStepExpr="$eq",this.sortFields=m.d,this.sortField="dates.from",this.sortOrders=m.e,this.sortOrder=1,this.date=this.sheduleService.convertDateToShort(new Date),this.maxDate=this.sheduleService.convertDateToShort(l.a(new Date,{years:1})),this.updated=!0}ngOnInit(){this.store.select(h.a).subscribe(e=>{if(console.log("company",e),e){const o=this.translate.instant("dif.all");this.rooms=[...e.rooms],this.rooms.unshift({_id:null,name:o}),this.room=this.rooms[0]}},e=>console.log("load rooms err",e)),this.store.select(h.b).subscribe(e=>this.user=e),this.store.select(M.a).subscribe(e=>{this.bookings=e}),this.translate.stream("elements.datePicker.monthNames").subscribe(e=>{this.updated=!1,this.monthNames=e,setTimeout(()=>this.updated=!0,1)}),this.route.url.subscribe(e=>{if(this.room){this.filter(),this.updated=!1;const e=this.translate.instant("dif.all");this.rooms[0].name=e,setTimeout(()=>this.updated=!0,1)}})}ionViewWillEnter(){}presentAlert(e){return Object(c.a)(this,void 0,void 0,function*(){const o=yield this.alertController.create({header:"Delete reservation",subHeader:"Reservation will be deleted",message:"Are you shure?",buttons:[{text:"Cancel",role:"cancel",handler:e=>{}},{text:"Ok",handler:()=>{this.delete(e);const o=this.createBookingQuery();this.store.dispatch(new u.a(o))}}]});yield o.present()})}createBookingQuery(){return{dateRangeLimits:this.sheduleService.createDateRangeLimits(this.sheduleService.convertISOToDate(this.date)),room_id:this.room._id,bookingStep:this.bookingStep?{val:this.bookingStep,expr:this.bookingStepExpr}:null,sort:{field:this.sortField,order:this.sortOrder}}}filter(){const e=this.createBookingQuery();this.store.dispatch(new u.a(e))}getBookings(e,o){return this.store.select(M.a).pipe(Object(g.a)(n=>n.filter(o=>o.room_id===e).map(e=>r.a(new Date(o),new Date(e.dates.from))?Object.assign(Object.assign({},e),{info:"start"}):r.a(new Date(o),new Date(e.dates.to))?Object.assign(Object.assign({},e),{info:"end"}):a.a(new Date(o),new Date(e.dates.from))&&d.a(new Date(o),new Date(e.dates.to))?Object.assign(Object.assign({},e),{info:"ahead"}):void 0).filter(e=>e).sort((e,o)=>new Date(e.dates.from).getTime()-new Date(o.dates.from).getTime()).map(e=>e)))}viewBooking(e){this.router.navigate(["/","shedule","edit",e])}delete(e){this.sheduleService.deleteBooking(e).subscribe(e=>e,e=>console.log("err delete",e))}update(e){this.router.navigateByUrl("/shedule/edit/"+e)}}return e.\u0275fac=function(o){return new(o||e)(p.Ib(f.a),p.Ib(N.i),p.Ib(s.g),p.Ib(s.a),p.Ib(b.a),p.Ib(k.d))},e.\u0275cmp=p.Cb({type:e,selectors:[["app-management"]],decls:82,vars:37,consts:[["slot","end"],["menu","analytics-menu"],["size-md","8","offset-md","2"],["color","primary","lines","none"],["pickerFormat","MMMM-YYYY","displayFormat","MMMM YYYY","placeholder","Select Month",3,"max","monthNames","ngModel","ngModelChange","ionChange",4,"ngIf"],["placeholder","Select One",3,"ngModel","ngModelChange","ionChange",4,"ngIf"],["placeholder","Select One",3,"ngModel","disabled","ngModelChange","ionChange",4,"ngIf"],[1,"ion-no-padding"],["size","3",1,"ion-no-padding"],["lines","none",1,"ion-no-padding"],[1,"ion-text-center"],["color","tertiary"],[4,"ngFor","ngForOf"],["pickerFormat","MMMM-YYYY","displayFormat","MMMM YYYY","placeholder","Select Month",3,"max","monthNames","ngModel","ngModelChange","ionChange"],["placeholder","Select One",3,"ngModel","ngModelChange","ionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["placeholder","Select One",3,"ngModel","disabled","ngModelChange","ionChange"],["lines","none"],["fill","clear",3,"ngClass","click"],["side","end",4,"ngIf"],["side","start",4,"ngIf"],["side","end"],["color","danger",3,"click"],["slot","icon-only","name","trash"],["side","start"],["color","primary",3,"click"],["slot","icon-only","name","pencil-outline"]],template:function(e,o){1&e&&(p.Nb(0,"ion-header"),p.Nb(1,"ion-toolbar"),p.Nb(2,"ion-title"),p.oc(3),p.Yb(4,"translate"),p.Mb(),p.Nb(5,"ion-buttons",0),p.Jb(6,"ion-menu-button",1),p.Mb(),p.Mb(),p.Nb(7,"ion-toolbar"),p.Nb(8,"ion-grid"),p.Nb(9,"ion-row"),p.Nb(10,"ion-col",2),p.Nb(11,"ion-item",3),p.Nb(12,"ion-label"),p.Nb(13,"ion-row"),p.Nb(14,"ion-col"),p.Nb(15,"ion-item"),p.Nb(16,"ion-label"),p.oc(17),p.Yb(18,"translate"),p.Mb(),p.nc(19,y,1,3,"ion-datetime",4),p.Mb(),p.Mb(),p.Nb(20,"ion-col"),p.Nb(21,"ion-item"),p.Nb(22,"ion-label"),p.oc(23),p.Yb(24,"translate"),p.Mb(),p.nc(25,S,2,2,"ion-select",5),p.Mb(),p.Mb(),p.Nb(26,"ion-col"),p.Nb(27,"ion-item"),p.Nb(28,"ion-label"),p.oc(29),p.Yb(30,"translate"),p.Mb(),p.nc(31,Y,2,2,"ion-select",5),p.Mb(),p.Mb(),p.Mb(),p.Nb(32,"ion-row"),p.Nb(33,"ion-col"),p.Nb(34,"ion-item"),p.Nb(35,"ion-label"),p.oc(36,"Room"),p.Mb(),p.nc(37,v,2,2,"ion-select",5),p.Mb(),p.Mb(),p.Nb(38,"ion-col"),p.Nb(39,"ion-item"),p.Nb(40,"ion-label"),p.oc(41),p.Yb(42,"translate"),p.Mb(),p.nc(43,X,2,2,"ion-select",5),p.Mb(),p.Mb(),p.Nb(44,"ion-col"),p.Nb(45,"ion-item"),p.Nb(46,"ion-label"),p.oc(47),p.Yb(48,"translate"),p.Mb(),p.nc(49,I,2,3,"ion-select",6),p.Mb(),p.Mb(),p.Mb(),p.Mb(),p.Mb(),p.Mb(),p.Mb(),p.Mb(),p.Mb(),p.Mb(),p.Nb(50,"ion-content"),p.Nb(51,"ion-grid"),p.Nb(52,"ion-row"),p.Nb(53,"ion-col",2),p.Nb(54,"ion-list"),p.Nb(55,"ion-list-header",7),p.Nb(56,"ion-label"),p.Nb(57,"ion-item"),p.Nb(58,"ion-label"),p.Nb(59,"ion-row"),p.Nb(60,"ion-col",8),p.Nb(61,"ion-item",9),p.Nb(62,"ion-label",10),p.oc(63),p.Yb(64,"translate"),p.Mb(),p.Mb(),p.Mb(),p.Nb(65,"ion-col",8),p.Nb(66,"ion-item",9),p.Nb(67,"ion-label",10),p.oc(68),p.Yb(69,"translate"),p.Mb(),p.Mb(),p.Mb(),p.Nb(70,"ion-col",8),p.Nb(71,"ion-item",9),p.Nb(72,"ion-label",10),p.oc(73),p.Yb(74,"translate"),p.Mb(),p.Mb(),p.Mb(),p.Nb(75,"ion-col",8),p.Nb(76,"ion-item",9),p.Nb(77,"ion-label",10),p.Nb(78,"ion-text",11),p.oc(79),p.Yb(80,"translate"),p.Mb(),p.Mb(),p.Mb(),p.Mb(),p.Mb(),p.Mb(),p.Mb(),p.Mb(),p.Mb(),p.nc(81,q,28,15,"ng-container",12),p.Mb(),p.Mb(),p.Mb(),p.Mb(),p.Mb()),2&e&&(p.yb(3),p.pc(p.Zb(4,17,"management")),p.yb(14),p.pc(p.Zb(18,19,"elements.datePicker.chooseMonth")),p.yb(2),p.dc("ngIf",o.updated),p.yb(4),p.pc(p.Zb(24,21,"common.sortFields.title")),p.yb(2),p.dc("ngIf",o.updated),p.yb(4),p.pc(p.Zb(30,23,"common.sortOrders.title")),p.yb(2),p.dc("ngIf",o.updated),p.yb(6),p.dc("ngIf",o.updated),p.yb(4),p.pc(p.Zb(42,25,"common.bookingSteps.title")),p.yb(2),p.dc("ngIf",o.updated),p.yb(4),p.pc(p.Zb(48,27,"common.bookingStepExprs.title")),p.yb(2),p.dc("ngIf",o.updated),p.yb(14),p.qc(" ",p.Zb(64,29,"common.bookingSteps.title")," "),p.yb(5),p.qc(" ",p.Zb(69,31,"common.sortFields.dates.from")," "),p.yb(5),p.qc(" ",p.Zb(74,33,"common.sortFields.dates.to")," "),p.yb(6),p.qc(" ",p.Zb(80,35,"common.sortFields.price")," "),p.yb(2),p.dc("ngForOf",o.bookings))},directives:[b.q,b.T,b.R,b.g,b.D,b.p,b.J,b.m,b.t,b.z,t.n,b.n,b.A,b.B,b.Q,t.m,b.o,b.cb,i.k,i.m,b.K,b.L,b.y,b.f,t.l,b.x,b.w,b.r],pipes:[k.c,t.e],styles:["ion-label[_ngcontent-%COMP%]{margin:0}"]}),e})()}];let E=(()=>{class e{}return e.\u0275mod=p.Gb({type:e}),e.\u0275inj=p.Fb({factory:function(o){return new(o||e)},imports:[[s.k.forChild(j)],s.k]}),e})();var V=n("FUS3");let $=(()=>{class e{}return e.\u0275mod=p.Gb({type:e}),e.\u0275inj=p.Fb({factory:function(o){return new(o||e)},imports:[[t.c,i.h,i.n,b.U,E,k.b.forChild({extend:!0}),V.a]]}),e})()}}]);