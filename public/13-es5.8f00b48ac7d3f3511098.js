!function(){function e(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,o){if(!e)return;if("string"==typeof e)return n(e,o);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return n(e,o)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,n){(null==n||n>e.length)&&(n=e.length);for(var o=0,t=new Array(n);o<n;o++)t[o]=e[o];return t}function o(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function t(e,n){for(var o=0;o<n.length;o++){var t=n[o];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{nhAk:function(n,i,r){"use strict";r.r(i),r.d(i,"ManagementPageModule",function(){return P});var b=r("ofXK"),a=r("3Pt+"),c=r("TEn/"),l=r("tyNb"),s=r("mrSG"),d=r("IjAw"),u=r("zHMj"),f=r("EhJz"),m=r("dndX"),g=r("PQ5l"),p=r("lJxs"),M=r("tJKL"),h=r("4dfA"),N=r("mgGq"),y=r("fXoL"),k=r("mrZj"),v=r("l7P3"),S=r("sYmb");function O(e,n){if(1&e){var o=y.Ob();y.Nb(0,"ion-datetime",13),y.Vb("ngModelChange",function(e){return y.kc(o),y.Xb().date=e})("ionChange",function(){return y.kc(o),y.Xb().filter()}),y.Mb()}if(2&e){var t=y.Xb();y.ec("monthNames",t.monthNames),y.dc("max",t.maxDate)("ngModel",t.date)}}function w(e,n){if(1&e&&(y.Nb(0,"ion-select-option",16),y.oc(1),y.Yb(2,"translate"),y.Mb()),2&e){var o=n.$implicit;y.dc("value",o),y.yb(1),y.qc(" ",y.Zb(2,2,"common.sortFields."+o)," ")}}function C(e,n){if(1&e){var o=y.Ob();y.Nb(0,"ion-select",14),y.Vb("ngModelChange",function(e){return y.kc(o),y.Xb().sortField=e})("ionChange",function(){return y.kc(o),y.Xb().filter()}),y.nc(1,w,3,4,"ion-select-option",15),y.Mb()}if(2&e){var t=y.Xb();y.dc("ngModel",t.sortField),y.yb(1),y.dc("ngForOf",t.sortFields)}}function Y(e,n){if(1&e&&(y.Nb(0,"ion-select-option",16),y.oc(1),y.Yb(2,"translate"),y.Mb()),2&e){var o=n.$implicit;y.dc("value",o),y.yb(1),y.qc(" ",y.Zb(2,2,"common.sortOrders."+o)," ")}}function F(e,n){if(1&e){var o=y.Ob();y.Nb(0,"ion-select",14),y.Vb("ngModelChange",function(e){return y.kc(o),y.Xb().sortOrder=e})("ionChange",function(){return y.kc(o),y.Xb().filter()}),y.nc(1,Y,3,4,"ion-select-option",15),y.Mb()}if(2&e){var t=y.Xb();y.dc("ngModel",t.sortOrder),y.yb(1),y.dc("ngForOf",t.sortOrders)}}function X(e,n){if(1&e&&(y.Nb(0,"ion-select-option",16),y.oc(1),y.Mb()),2&e){var o=n.$implicit;y.dc("value",o),y.yb(1),y.qc("",o.name," ")}}function x(e,n){if(1&e){var o=y.Ob();y.Nb(0,"ion-select",14),y.Vb("ngModelChange",function(e){return y.kc(o),y.Xb().room=e})("ionChange",function(){return y.kc(o),y.Xb().filter()}),y.nc(1,X,2,2,"ion-select-option",15),y.Mb()}if(2&e){var t=y.Xb();y.dc("ngModel",t.room),y.yb(1),y.dc("ngForOf",t.rooms)}}function I(e,n){if(1&e&&(y.Nb(0,"ion-select-option",16),y.oc(1),y.Yb(2,"translate"),y.Mb()),2&e){var o=n.$implicit;y.dc("value",o),y.yb(1),y.qc(" ",y.Zb(2,2,"common.bookingSteps."+o)," ")}}function D(e,n){if(1&e){var o=y.Ob();y.Nb(0,"ion-select",14),y.Vb("ngModelChange",function(e){return y.kc(o),y.Xb().bookingStep=e})("ionChange",function(){return y.kc(o),y.Xb().filter()}),y.nc(1,I,3,4,"ion-select-option",15),y.Mb()}if(2&e){var t=y.Xb();y.dc("ngModel",t.bookingStep),y.yb(1),y.dc("ngForOf",t.bookingSteps)}}function j(e,n){if(1&e&&(y.Nb(0,"ion-select-option",16),y.oc(1),y.Yb(2,"translate"),y.Mb()),2&e){var o=n.$implicit;y.dc("value",o),y.yb(1),y.qc(" ",y.Zb(2,2,"common.bookingStepExprs."+o)," ")}}function Z(e,n){if(1&e){var o=y.Ob();y.Nb(0,"ion-select",17),y.Vb("ngModelChange",function(e){return y.kc(o),y.Xb().bookingStepExpr=e})("ionChange",function(){return y.kc(o),y.Xb().filter()}),y.nc(1,j,3,4,"ion-select-option",15),y.Mb()}if(2&e){var t=y.Xb();y.dc("ngModel",t.bookingStepExpr)("disabled",!t.bookingStep),y.yb(1),y.dc("ngForOf",t.bookingStepExprs)}}function q(e,n){if(1&e){var o=y.Ob();y.Nb(0,"ion-item-options",22),y.Nb(1,"ion-item-option",23),y.Vb("click",function(){y.kc(o);var e=y.Xb().$implicit;return y.Xb().presentAlert(e._id)}),y.Jb(2,"ion-icon",24),y.Mb(),y.Mb()}}function A(e,n){if(1&e){var o=y.Ob();y.Nb(0,"ion-item-options",25),y.Nb(1,"ion-item-option",26),y.Vb("click",function(){y.kc(o);var e=y.Xb().$implicit;return y.Xb().update(e._id)}),y.Jb(2,"ion-icon",27),y.Mb(),y.Mb()}}function E(e,n){if(1&e){var o=y.Ob();y.Lb(0),y.Nb(1,"ion-item-sliding"),y.Nb(2,"ion-item",18),y.Nb(3,"ion-label"),y.Nb(4,"ion-row"),y.Nb(5,"ion-col",8),y.Nb(6,"ion-item",9),y.Nb(7,"ion-label",10),y.Nb(8,"ion-button",19),y.Vb("click",function(){y.kc(o);var e=n.$implicit;return y.Xb().viewBooking(e._id)}),y.oc(9),y.Yb(10,"translate"),y.Mb(),y.Mb(),y.Mb(),y.Mb(),y.Nb(11,"ion-col",8),y.Nb(12,"ion-item",9),y.Nb(13,"ion-label",10),y.oc(14),y.Yb(15,"date"),y.Mb(),y.Mb(),y.Mb(),y.Nb(16,"ion-col",8),y.Nb(17,"ion-item",9),y.Nb(18,"ion-label",10),y.oc(19),y.Yb(20,"date"),y.Mb(),y.Mb(),y.Mb(),y.Nb(21,"ion-col",8),y.Nb(22,"ion-item",9),y.Nb(23,"ion-label",10),y.Nb(24,"ion-text",11),y.oc(25),y.Mb(),y.Mb(),y.Mb(),y.Mb(),y.Mb(),y.Mb(),y.Mb(),y.nc(26,q,3,0,"ion-item-options",20),y.nc(27,A,3,0,"ion-item-options",21),y.Mb(),y.Kb()}if(2&e){var t=n.$implicit,i=y.Xb();y.yb(8),y.dc("ngClass","status-color_"+t.bookingStep),y.yb(1),y.pc(y.Zb(10,7,"common.bookingSteps."+t.bookingStep)),y.yb(5),y.qc(" ",y.ac(15,9,t.dates.from,"dd MMM")," "),y.yb(5),y.qc(" ",y.ac(20,12,t.dates.to,"dd MMM")," "),y.yb(6),y.qc(" ",t.price," "),y.yb(1),y.dc("ngIf",!(null!=i.user&&i.user.blocked)),y.yb(1),y.dc("ngIf","cancelled"!==t.bookingStep&&!(null!=i.user&&i.user.blocked))}}var T,$,V,B=[{path:"",component:(T=function(){function n(e,t,i,r,b,a){o(this,n),this.sheduleService=e,this.store=t,this.router=i,this.route=r,this.alertController=b,this.translate=a,this.bookingSteps=g.b,this.bookingStep="cancelled",this.bookingStepExprs=g.a,this.bookingStepExpr="$eq",this.sortFields=g.d,this.sortField="dates.from",this.sortOrders=g.e,this.sortOrder=1,this.date=this.sheduleService.convertDateToShort(new Date),this.maxDate=this.sheduleService.convertDateToShort(d.a(new Date,{years:1})),this.updated=!0}var i,r,b;return i=n,(r=[{key:"ngOnInit",value:function(){var n=this;this.store.select(N.a).subscribe(function(o){if(console.log("company",o),o){var t=n.translate.instant("dif.all");n.rooms=e(o.rooms),n.rooms.unshift({_id:null,name:t}),n.room=n.rooms[0]}},function(e){return console.log("load rooms err",e)}),this.store.select(N.b).subscribe(function(e){return n.user=e}),this.store.select(M.a).subscribe(function(e){n.bookings=e}),this.translate.stream("elements.datePicker.monthNames").subscribe(function(e){n.updated=!1,n.monthNames=e,setTimeout(function(){return n.updated=!0},1)}),this.route.url.subscribe(function(e){if(n.room){n.filter(),n.updated=!1;var o=n.translate.instant("dif.all");n.rooms[0].name=o,setTimeout(function(){return n.updated=!0},1)}})}},{key:"ionViewWillEnter",value:function(){}},{key:"presentAlert",value:function(e){return Object(s.a)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var o,t=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.alertController.create({header:"Delete reservation",subHeader:"Reservation will be deleted",message:"Are you shure?",buttons:[{text:"Cancel",role:"cancel",handler:function(e){}},{text:"Ok",handler:function(){t.delete(e);var n=t.createBookingQuery();t.store.dispatch(new h.a(n))}}]});case 2:return o=n.sent,n.next=5,o.present();case 5:case"end":return n.stop()}},n,this)}))}},{key:"createBookingQuery",value:function(){return{dateRangeLimits:this.sheduleService.createDateRangeLimits(this.sheduleService.convertISOToDate(this.date)),room_id:this.room._id,bookingStep:this.bookingStep?{val:this.bookingStep,expr:this.bookingStepExpr}:null,sort:{field:this.sortField,order:this.sortOrder}}}},{key:"filter",value:function(){var e=this.createBookingQuery();this.store.dispatch(new h.a(e))}},{key:"getBookings",value:function(e,n){return this.store.select(M.a).pipe(Object(p.a)(function(o){return o.filter(function(n){return n.room_id===e}).map(function(e){return u.a(new Date(n),new Date(e.dates.from))?Object.assign(Object.assign({},e),{info:"start"}):u.a(new Date(n),new Date(e.dates.to))?Object.assign(Object.assign({},e),{info:"end"}):f.a(new Date(n),new Date(e.dates.from))&&m.a(new Date(n),new Date(e.dates.to))?Object.assign(Object.assign({},e),{info:"ahead"}):void 0}).filter(function(e){return e}).sort(function(e,n){return new Date(e.dates.from).getTime()-new Date(n.dates.from).getTime()}).map(function(e){return e})}))}},{key:"viewBooking",value:function(e){this.router.navigate(["/","shedule","edit",e])}},{key:"delete",value:function(e){this.sheduleService.deleteBooking(e).subscribe(function(e){return e},function(e){return console.log("err delete",e)})}},{key:"update",value:function(e){this.router.navigateByUrl("/shedule/edit/"+e)}}])&&t(i.prototype,r),b&&t(i,b),n}(),T.\u0275fac=function(e){return new(e||T)(y.Ib(k.a),y.Ib(v.i),y.Ib(l.g),y.Ib(l.a),y.Ib(c.a),y.Ib(S.d))},T.\u0275cmp=y.Cb({type:T,selectors:[["app-management"]],decls:82,vars:37,consts:[["slot","end"],["menu","analytics-menu"],["size-md","8","offset-md","2"],["color","primary","lines","none"],["pickerFormat","MMMM-YYYY","displayFormat","MMMM YYYY","placeholder","Select Month",3,"max","monthNames","ngModel","ngModelChange","ionChange",4,"ngIf"],["placeholder","Select One",3,"ngModel","ngModelChange","ionChange",4,"ngIf"],["placeholder","Select One",3,"ngModel","disabled","ngModelChange","ionChange",4,"ngIf"],[1,"ion-no-padding"],["size","3",1,"ion-no-padding"],["lines","none",1,"ion-no-padding"],[1,"ion-text-center"],["color","tertiary"],[4,"ngFor","ngForOf"],["pickerFormat","MMMM-YYYY","displayFormat","MMMM YYYY","placeholder","Select Month",3,"max","monthNames","ngModel","ngModelChange","ionChange"],["placeholder","Select One",3,"ngModel","ngModelChange","ionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["placeholder","Select One",3,"ngModel","disabled","ngModelChange","ionChange"],["lines","none"],["fill","clear",3,"ngClass","click"],["side","end",4,"ngIf"],["side","start",4,"ngIf"],["side","end"],["color","danger",3,"click"],["slot","icon-only","name","trash"],["side","start"],["color","primary",3,"click"],["slot","icon-only","name","pencil-outline"]],template:function(e,n){1&e&&(y.Nb(0,"ion-header"),y.Nb(1,"ion-toolbar"),y.Nb(2,"ion-title"),y.oc(3),y.Yb(4,"translate"),y.Mb(),y.Nb(5,"ion-buttons",0),y.Jb(6,"ion-menu-button",1),y.Mb(),y.Mb(),y.Nb(7,"ion-toolbar"),y.Nb(8,"ion-grid"),y.Nb(9,"ion-row"),y.Nb(10,"ion-col",2),y.Nb(11,"ion-item",3),y.Nb(12,"ion-label"),y.Nb(13,"ion-row"),y.Nb(14,"ion-col"),y.Nb(15,"ion-item"),y.Nb(16,"ion-label"),y.oc(17),y.Yb(18,"translate"),y.Mb(),y.nc(19,O,1,3,"ion-datetime",4),y.Mb(),y.Mb(),y.Nb(20,"ion-col"),y.Nb(21,"ion-item"),y.Nb(22,"ion-label"),y.oc(23),y.Yb(24,"translate"),y.Mb(),y.nc(25,C,2,2,"ion-select",5),y.Mb(),y.Mb(),y.Nb(26,"ion-col"),y.Nb(27,"ion-item"),y.Nb(28,"ion-label"),y.oc(29),y.Yb(30,"translate"),y.Mb(),y.nc(31,F,2,2,"ion-select",5),y.Mb(),y.Mb(),y.Mb(),y.Nb(32,"ion-row"),y.Nb(33,"ion-col"),y.Nb(34,"ion-item"),y.Nb(35,"ion-label"),y.oc(36,"Room"),y.Mb(),y.nc(37,x,2,2,"ion-select",5),y.Mb(),y.Mb(),y.Nb(38,"ion-col"),y.Nb(39,"ion-item"),y.Nb(40,"ion-label"),y.oc(41),y.Yb(42,"translate"),y.Mb(),y.nc(43,D,2,2,"ion-select",5),y.Mb(),y.Mb(),y.Nb(44,"ion-col"),y.Nb(45,"ion-item"),y.Nb(46,"ion-label"),y.oc(47),y.Yb(48,"translate"),y.Mb(),y.nc(49,Z,2,3,"ion-select",6),y.Mb(),y.Mb(),y.Mb(),y.Mb(),y.Mb(),y.Mb(),y.Mb(),y.Mb(),y.Mb(),y.Mb(),y.Nb(50,"ion-content"),y.Nb(51,"ion-grid"),y.Nb(52,"ion-row"),y.Nb(53,"ion-col",2),y.Nb(54,"ion-list"),y.Nb(55,"ion-list-header",7),y.Nb(56,"ion-label"),y.Nb(57,"ion-item"),y.Nb(58,"ion-label"),y.Nb(59,"ion-row"),y.Nb(60,"ion-col",8),y.Nb(61,"ion-item",9),y.Nb(62,"ion-label",10),y.oc(63),y.Yb(64,"translate"),y.Mb(),y.Mb(),y.Mb(),y.Nb(65,"ion-col",8),y.Nb(66,"ion-item",9),y.Nb(67,"ion-label",10),y.oc(68),y.Yb(69,"translate"),y.Mb(),y.Mb(),y.Mb(),y.Nb(70,"ion-col",8),y.Nb(71,"ion-item",9),y.Nb(72,"ion-label",10),y.oc(73),y.Yb(74,"translate"),y.Mb(),y.Mb(),y.Mb(),y.Nb(75,"ion-col",8),y.Nb(76,"ion-item",9),y.Nb(77,"ion-label",10),y.Nb(78,"ion-text",11),y.oc(79),y.Yb(80,"translate"),y.Mb(),y.Mb(),y.Mb(),y.Mb(),y.Mb(),y.Mb(),y.Mb(),y.Mb(),y.Mb(),y.nc(81,E,28,15,"ng-container",12),y.Mb(),y.Mb(),y.Mb(),y.Mb(),y.Mb()),2&e&&(y.yb(3),y.pc(y.Zb(4,17,"management")),y.yb(14),y.pc(y.Zb(18,19,"elements.datePicker.chooseMonth")),y.yb(2),y.dc("ngIf",n.updated),y.yb(4),y.pc(y.Zb(24,21,"common.sortFields.title")),y.yb(2),y.dc("ngIf",n.updated),y.yb(4),y.pc(y.Zb(30,23,"common.sortOrders.title")),y.yb(2),y.dc("ngIf",n.updated),y.yb(6),y.dc("ngIf",n.updated),y.yb(4),y.pc(y.Zb(42,25,"common.bookingSteps.title")),y.yb(2),y.dc("ngIf",n.updated),y.yb(4),y.pc(y.Zb(48,27,"common.bookingStepExprs.title")),y.yb(2),y.dc("ngIf",n.updated),y.yb(14),y.qc(" ",y.Zb(64,29,"common.bookingSteps.title")," "),y.yb(5),y.qc(" ",y.Zb(69,31,"common.sortFields.dates.from")," "),y.yb(5),y.qc(" ",y.Zb(74,33,"common.sortFields.dates.to")," "),y.yb(6),y.qc(" ",y.Zb(80,35,"common.sortFields.price")," "),y.yb(2),y.dc("ngForOf",n.bookings))},directives:[c.q,c.T,c.R,c.g,c.D,c.p,c.J,c.m,c.t,c.z,b.n,c.n,c.A,c.B,c.Q,b.m,c.o,c.cb,a.k,a.m,c.K,c.L,c.y,c.f,b.l,c.x,c.w,c.r],pipes:[S.c,b.e],styles:["ion-label[_ngcontent-%COMP%]{margin:0}"]}),T)}],J=(($=function e(){o(this,e)}).\u0275mod=y.Gb({type:$}),$.\u0275inj=y.Fb({factory:function(e){return new(e||$)},imports:[[l.k.forChild(B)],l.k]}),$),_=r("FUS3"),P=((V=function e(){o(this,e)}).\u0275mod=y.Gb({type:V}),V.\u0275inj=y.Fb({factory:function(e){return new(e||V)},imports:[[b.c,a.h,a.n,c.U,J,S.b.forChild({extend:!0}),_.a]]}),V)}}])}();