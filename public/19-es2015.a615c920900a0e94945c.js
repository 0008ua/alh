(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{"9ziR":function(e,n,t){"use strict";t.r(n),t.d(n,"ShedulePageModule",function(){return T});var o=t("ofXK"),i=t("3Pt+"),r=t("TEn/"),a=t("tyNb"),s=t("E2UR"),c=t("IjAw"),d=t("zHMj"),l=t("EhJz"),b=t("dndX"),g=t("OuL/"),h=t("9ig3"),p=t("/Tr7"),u=t("jIYg");function m(e,n){Object(u.a)(1,arguments);var t=e||{},o=Object(p.a)(t.start),i=Object(p.a)(t.end),r=i.getTime();if(!(o.getTime()<=r))throw new RangeError("Invalid interval");var a=[],s=o;s.setHours(0,0,0,0);var c=n&&"step"in n?Number(n.step):1;if(c<1||isNaN(c))throw new RangeError("`options.step` must be a number greater than 1");for(;s.getTime()<=r;)a.push(Object(p.a)(s)),s.setDate(s.getDate()+c),s.setHours(0,0,0,0);return a}var f=t("lJxs"),M=t("4dfA"),_=t("mYIz"),w=t("tJKL"),k=t("mgGq"),y=t("fXoL"),x=t("l7P3"),O=t("mrZj"),C=t("sYmb");function N(e,n){if(1&e){const e=y.Ob();y.Nb(0,"ion-button",4),y.Vb("click",function(){return y.jc(e),y.Xb().bookingInfo()}),y.Jb(1,"ion-icon",5),y.Mb()}}const P=function(e,n,t){return[e,n,t]};function S(e,n){if(1&e){const e=y.Ob();y.Nb(0,"div",6),y.Vb("click",function(){y.jc(e);const t=n.$implicit;return y.Xb().bookingInfo(t)}),y.Mb()}if(2&e){const e=n.$implicit;y.dc("ngClass",y.gc(1,P,"status-background-color_"+e.bookingStep,"shedule-item__info_"+e.info,"shedule-item__info_"+e.bookingStep))}}function v(e,n){if(1&e){const e=y.Ob();y.Nb(0,"ion-button",7),y.Vb("click",function(){return y.jc(e),y.Xb().bookingInfo()}),y.Jb(1,"ion-icon",5),y.Mb()}}let I=(()=>{class e{constructor(e){this.router=e}ngOnInit(){}bookingInfo(e){this.router.navigate(e?["/","shedule","edit",e._id]:["/","shedule","new",this.room_id,this.date])}}return e.\u0275fac=function(n){return new(n||e)(y.Ib(a.g))},e.\u0275cmp=y.Cb({type:e,selectors:[["app-shedule-item"]],inputs:{bookings:"bookings",date:"date",room_id:"room_id"},decls:4,vars:3,consts:[[1,"shedule-item"],["class","shedule-item__info ion-no-margin","fill","none","routerDirection","forward",3,"click",4,"ngIf"],["class","shedule-item__info",3,"ngClass","click",4,"ngFor","ngForOf"],["class","shedule-item__info ion-no-margin","fill","none","size","small","routerDirection","forward",3,"click",4,"ngIf"],["fill","none","routerDirection","forward",1,"shedule-item__info","ion-no-margin",3,"click"],["slot","icon-only","size","small","name","add-circle-outline","color","success"],[1,"shedule-item__info",3,"ngClass","click"],["fill","none","size","small","routerDirection","forward",1,"shedule-item__info","ion-no-margin",3,"click"]],template:function(e,n){1&e&&(y.Nb(0,"div",0),y.mc(1,N,2,0,"ion-button",1),y.mc(2,S,1,5,"div",2),y.mc(3,v,2,0,"ion-button",3),y.Mb()),2&e&&(y.yb(1),y.dc("ngIf",!n.bookings||!n.bookings.length),y.yb(1),y.dc("ngForOf",n.bookings),y.yb(1),y.dc("ngIf",1===(null==n.bookings?null:n.bookings.length)&&"end"===n.bookings[0].info))},directives:[o.n,o.m,r.f,r.r,o.l],styles:["ion-button[_ngcontent-%COMP%]{--padding-start:0px;--padding-end:0px}.shedule-item[_ngcontent-%COMP%]{height:100%;display:flex;flex-flow:row nowrap;align-items:center}.shedule-item__info[_ngcontent-%COMP%]{height:1.5em;font-size:13px;font-weight:500;flex:1 1 auto}.shedule-item__info_start[_ngcontent-%COMP%]{border-radius:10px 0 0 10px}.shedule-item__info_ahead[_ngcontent-%COMP%], .shedule-item__info_start[_ngcontent-%COMP%]{border-right:.5px solid #d3d3d3}.shedule-item__info_end[_ngcontent-%COMP%]{border-radius:0 10px 10px 0}.shedule-item__date[_ngcontent-%COMP%]{position:absolute;left:2px;top:2px}"]}),e})();function Y(e,n){if(1&e){const e=y.Ob();y.Nb(0,"ion-datetime",14),y.Vb("ngModelChange",function(n){return y.jc(e),y.Xb().pickedMonth=n})("ionChange",function(){return y.jc(e),y.Xb().onMonthChange()}),y.Mb()}if(2&e){const e=y.Xb();y.ec("monthNames",e.monthNames),y.dc("max",e.maxPickedMonth)("ngModel",e.pickedMonth)}}function R(e,n){if(1&e&&(y.Nb(0,"ion-col",15),y.nc(1),y.Yb(2,"date"),y.Mb()),2&e){const e=n.$implicit;y.yb(1),y.pc(" ",y.ac(2,1,e,"dd ")," ")}}function D(e,n){if(1&e&&(y.Nb(0,"ion-col",19),y.Jb(1,"app-shedule-item",20),y.Yb(2,"async"),y.Mb()),2&e){const e=n.$implicit,t=y.Xb().$implicit,o=y.Xb();y.yb(1),y.dc("bookings",y.Zb(2,3,o.getBookings(t._id,e)))("date",e)("room_id",t._id)}}function j(e,n){if(1&e&&(y.Nb(0,"ion-item"),y.Nb(1,"ion-grid"),y.Nb(2,"ion-row",16),y.Nb(3,"ion-col",17),y.nc(4),y.Mb(),y.mc(5,D,3,5,"ion-col",18),y.Mb(),y.Mb(),y.Mb()),2&e){const e=n.$implicit,t=y.Xb();y.yb(4),y.pc(" ",e.name," "),y.yb(1),y.dc("ngForOf",t.selectedRange)}}const z=[{path:"",component:(()=>{class e{constructor(e,n,t){this.store=e,this.sheduleService=n,this.translate=t,this.pickedMonth=this.sheduleService.convertDateToShort(new Date),this.maxPickedMonth=this.sheduleService.convertDateToShort(c.a(new Date,{years:1})),this.range=[],this.selectedRange=[],this.updated=!0,this.daysInSelectedArray=10,this.knobs={lower:0,upper:this.daysInSelectedArray-1},this.knobChangedProgrammatically=!1}ngOnInit(){const e=new Date;this.createRange(e),this.createSelectedRange(this.knobs),this.translate.stream("elements.datePicker.monthNames").subscribe(e=>{this.updated=!1,this.monthNames=e,setTimeout(()=>this.updated=!0,1)}),this.store.select(k.a).subscribe(e=>{e&&(this.rooms=e.rooms)},e=>console.log("load rooms err",e)),this.lang=this.translate.currentLang}ionViewWillEnter(){this.store.dispatch(new _.f),this.store.dispatch(new M.a({dateRangeLimits:this.createRangeLimits(),bookingStep:{expr:"$ne",val:"cancelled"}})),this.updated=!1,setTimeout(()=>this.updated=!0,1)}getBookings(e,n){return this.store.select(w.a).pipe(Object(f.a)(t=>t.filter(n=>n.room_id===e).map(e=>d.a(new Date(n),new Date(e.dates.from))?Object.assign(Object.assign({},e),{info:"start"}):d.a(new Date(n),new Date(e.dates.to))?Object.assign(Object.assign({},e),{info:"end"}):l.a(new Date(n),new Date(e.dates.from))&&b.a(new Date(n),new Date(e.dates.to))?Object.assign(Object.assign({},e),{info:"ahead"}):void 0).filter(e=>e).sort((e,n)=>new Date(e.dates.from).getTime()-new Date(n.dates.from).getTime()).map(e=>e)))}onMonthChange(){const e=new Date(this.pickedMonth);this.createRange(e),this.createSelectedRange({lower:0,upper:9}),this.store.dispatch(new M.a({dateRangeLimits:this.createRangeLimits(),bookingStep:{expr:"$ne",val:"cancelled"}}))}onRangeChange(e){this.knobChangedProgrammatically?this.knobChangedProgrammatically=!1:(this.knobs=this.knobs.lower!==this.selectedRangeKnobs.lower?this.knobs.lower<0?{lower:0,upper:this.daysInSelectedArray-1}:this.knobs.lower>this.rangeKnobs.upper-this.daysInSelectedArray-1?{lower:this.rangeKnobs.upper-this.daysInSelectedArray+1,upper:this.rangeKnobs.upper}:{lower:this.knobs.lower,upper:this.knobs.lower+this.daysInSelectedArray-1}:this.knobs.upper>this.rangeKnobs.upper?{lower:this.rangeKnobs.upper-this.daysInSelectedArray-1,upper:this.rangeKnobs.upper}:this.knobs.upper<this.daysInSelectedArray?{lower:0,upper:this.daysInSelectedArray-1}:{lower:this.knobs.upper-this.daysInSelectedArray+1,upper:this.knobs.upper},this.createSelectedRange(this.knobs),this.knobChangedProgrammatically=!0)}createRangeLimits(){return{lower:this.range[0],upper:this.range[this.range.length-1]}}createRange(e){const n=g.a(e),t=h.a(e),o=c.a(t,{days:n-1});this.range=m({start:t,end:o}).map(e=>this.sheduleService.convertDateToShort(e)),this.rangeKnobs={lower:0,upper:this.range.length-1}}createSelectedRange(e){this.selectedRange=m({start:this.sheduleService.convertShortToDate(this.range[e.lower]),end:this.sheduleService.convertShortToDate(this.range[e.upper])}).map(e=>this.sheduleService.convertDateToShort(e)),this.selectedRangeKnobs={lower:e.lower,upper:e.upper}}switchLanguage(){this.lang="en"===this.lang?"uk":"en",this.translate.use(this.lang)}}return e.\u0275fac=function(n){return new(n||e)(y.Ib(x.i),y.Ib(O.a),y.Ib(C.d))},e.\u0275cmp=y.Cb({type:e,selectors:[["app-shedule"]],decls:48,vars:40,consts:[["color","primary"],["slot","end"],["color","primary","button","","lines","none",3,"click"],["name","earth-outline","slot","start"],["size-md","6","offset-md","3"],["pickerFormat","MMMM-YYYY","displayFormat","MMMM YYYY","placeholder","Select Month",3,"max","ngModel","monthNames","ngModelChange","ionChange",4,"ngIf"],["color","secondary","snaps","true","dualKnobs","true",3,"min","step","max","ngModel","ngModelChange","ionChange"],["slot","start",1,"ion-text-end"],["color","secondary"],["slot","end",1,"ion-text-start"],[1,"shedule-header"],["size","2",1,"ion-no-padding","shedule-header__range"],["class","ion-no-padding ion-text-center shedule-header__date","size","1",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["pickerFormat","MMMM-YYYY","displayFormat","MMMM YYYY","placeholder","Select Month",3,"max","ngModel","monthNames","ngModelChange","ionChange"],["size","1",1,"ion-no-padding","ion-text-center","shedule-header__date"],[1,"shedule-body"],["size","2",1,"ion-no-padding","ion-text-center","shedule-body__room-name"],["class","ion-no-padding","size","1",4,"ngFor","ngForOf"],["size","1",1,"ion-no-padding"],[3,"bookings","date","room_id"]],template:function(e,n){1&e&&(y.Nb(0,"ion-header"),y.Nb(1,"ion-toolbar",0),y.Nb(2,"ion-title"),y.nc(3),y.Yb(4,"translate"),y.Mb(),y.Nb(5,"ion-buttons",1),y.Nb(6,"ion-item",2),y.Vb("click",function(){return n.switchLanguage()}),y.Jb(7,"ion-icon",3),y.Nb(8,"ion-label"),y.nc(9),y.Yb(10,"translate"),y.Mb(),y.Mb(),y.Mb(),y.Mb(),y.Mb(),y.Nb(11,"ion-content"),y.Nb(12,"ion-grid"),y.Nb(13,"ion-row"),y.Nb(14,"ion-col",4),y.Nb(15,"ion-list"),y.Nb(16,"ion-item"),y.Nb(17,"ion-label"),y.nc(18),y.Yb(19,"translate"),y.Mb(),y.mc(20,Y,1,3,"ion-datetime",5),y.Mb(),y.Nb(21,"ion-item"),y.Nb(22,"ion-range",6),y.Vb("ngModelChange",function(e){return n.knobs=e})("ionChange",function(e){return n.onRangeChange(e)}),y.Nb(23,"ion-label",7),y.Nb(24,"ion-text"),y.nc(25),y.Yb(26,"date"),y.Mb(),y.Nb(27,"ion-text",8),y.Nb(28,"h2",8),y.nc(29),y.Yb(30,"date"),y.Mb(),y.Mb(),y.Mb(),y.Nb(31,"ion-label",9),y.Nb(32,"ion-text"),y.nc(33),y.Yb(34,"date"),y.Mb(),y.Nb(35,"ion-text",8),y.Nb(36,"h2",8),y.nc(37),y.Yb(38,"date"),y.Mb(),y.Mb(),y.Mb(),y.Mb(),y.Mb(),y.Nb(39,"ion-item"),y.Nb(40,"ion-grid"),y.Nb(41,"ion-row",10),y.Nb(42,"ion-col",11),y.nc(43),y.Yb(44,"date"),y.Yb(45,"date"),y.Mb(),y.mc(46,R,3,4,"ion-col",12),y.Mb(),y.Mb(),y.Mb(),y.mc(47,j,6,2,"ion-item",13),y.Mb(),y.Mb(),y.Mb(),y.Mb(),y.Mb()),2&e&&(y.yb(3),y.oc(y.Zb(4,16,"modules.shedule.title")),y.yb(6),y.oc(y.Zb(10,18,"language")),y.yb(9),y.oc(y.Zb(19,20,"elements.datePicker.chooseMonth")),y.yb(2),y.dc("ngIf",n.updated),y.yb(2),y.dc("min",0)("step",1)("max",n.range.length-1)("ngModel",n.knobs),y.yb(3),y.oc(y.ac(26,22,n.range[0],"dd MMM")),y.yb(4),y.pc(" ",y.ac(30,25,n.range[n.knobs.lower],"dd MMM")," "),y.yb(4),y.oc(y.ac(34,28,n.range[n.range.length-1],"dd MMM")),y.yb(4),y.pc(" ",y.ac(38,31,n.range[n.knobs.upper],"dd MMM")," "),y.yb(6),y.qc(" ",y.ac(44,34,n.selectedRange[0],"dd.MM")," - ",y.ac(45,37,n.selectedRange[n.selectedRange.length-1],"dd.MM")," "),y.yb(3),y.dc("ngForOf",n.selectedRange),y.yb(1),y.dc("ngForOf",n.rooms))},directives:[r.q,r.S,r.Q,r.g,r.t,r.r,r.z,r.n,r.p,r.J,r.m,r.A,o.n,r.H,r.bb,i.k,i.m,r.P,o.m,r.o,I],pipes:[C.c,o.e,o.b],styles:[".day[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;align-items:stretch;height:45px}.day__cell[_ngcontent-%COMP%]{border-right:1px solid #dfd6d6;border-bottom:1px solid #dfd6d6;border-radius:5px;flex:1 1 auto;text-align:center;padding:5px}.shedule-header[_ngcontent-%COMP%]{font-size:14px;font-weight:500;display:flex;flex-flow:row nowrap;align-items:center;justify-content:center}.shedule-header__date[_ngcontent-%COMP%]{border-left:.5px solid #d3d3d3}.shedule-body__room-name[_ngcontent-%COMP%]{min-height:2.1em;font-size:13px;font-weight:500}.block[_ngcontent-%COMP%]{border:1px solid grey;margin:4px 2px;height:36px;font-size:14px;font-weight:500;letter-spacing:.06em;text-transform:uppercase}.block_small[_ngcontent-%COMP%]{height:2.1em;font-size:13px}.block_large[_ngcontent-%COMP%]{height:2.8em;font-size:20px}.small[_ngcontent-%COMP%]{width:27px;height:27px}.mid[_ngcontent-%COMP%], .small[_ngcontent-%COMP%]{border:1px solid grey;margin:4px 2px}.mid[_ngcontent-%COMP%]{width:36px;height:36px}.big[_ngcontent-%COMP%]{width:56px;height:56px;border:1px solid grey;margin:4px 2px}.flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap}.flex-container__button[_ngcontent-%COMP%]{flex:1 1 auto}.free[_ngcontent-%COMP%]{background:linear-gradient(to bottom right,rgba(0,255,0,.1) 0,rgba(0,255,0,.7) 8%,rgba(0,255,0,0) 10%,transparent),linear-gradient(to top left,rgba(0,255,0,.1) 0,rgba(0,255,0,.7) 10%,rgba(0,255,0,0) 15%,transparent)}.free_morning[_ngcontent-%COMP%]{background:linear-gradient(to bottom right,rgba(0,255,0,.1) 0,rgba(0,255,0,.7) 8%,rgba(0,255,0,0) 10%,transparent),linear-gradient(to top left,rgba(255,0,0,.1) 0,rgba(255,0,0,.7) 10%,rgba(255,0,0,0) 15%,transparent)}.free_evening[_ngcontent-%COMP%]{background:linear-gradient(to bottom right,rgba(255,0,0,.1) 0,rgba(255,0,0,.7) 8%,rgba(255,0,0,0) 10%,transparent),linear-gradient(to top left,rgba(0,255,0,.1) 0,rgba(0,255,0,.7) 10%,rgba(0,255,0,0) 15%,transparent)}.free_none[_ngcontent-%COMP%]{background:linear-gradient(to bottom right,rgba(255,0,0,.1) 0,rgba(255,0,0,.7) 8%,rgba(255,0,0,0) 10%,transparent),linear-gradient(to top left,rgba(255,0,0,.1) 0,rgba(255,0,0,.7) 10%,rgba(255,0,0,0) 15%,transparent)}"]}),e})()},{path:"new/:roomId/:date",loadChildren:()=>Promise.all([t.e(0),t.e(2)]).then(t.bind(null,"LOB2")).then(e=>e.BookingFormPageModule),canLoad:[s.a],canActivate:[s.a]},{path:"edit/:bookingId",loadChildren:()=>Promise.all([t.e(0),t.e(2)]).then(t.bind(null,"LOB2")).then(e=>e.BookingFormPageModule)},{path:"**",redirectTo:"",pathMatch:"full"}];let F=(()=>{class e{}return e.\u0275mod=y.Gb({type:e}),e.\u0275inj=y.Fb({factory:function(n){return new(n||e)},imports:[[a.k.forChild(z)],a.k]}),e})(),T=(()=>{class e{}return e.\u0275mod=y.Gb({type:e}),e.\u0275inj=y.Fb({factory:function(n){return new(n||e)},imports:[[o.c,i.h,r.T,F,C.b.forChild({extend:!0})]]}),e})()}}]);