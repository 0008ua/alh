(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{nhAk:function(e,n,o){"use strict";o.r(n),o.d(n,"ManagementPageModule",function(){return B});var t=o("ofXK"),i=o("3Pt+"),b=o("TEn/"),s=o("tyNb"),c=o("mrSG"),l=o("IjAw"),r=o("zHMj"),a=o("EhJz"),d=o("dndX"),m=o("PQ5l"),g=o("lJxs"),M=o("tJKL"),u=o("4dfA"),p=o("mgGq"),h=o("fXoL"),f=o("mrZj"),N=o("l7P3"),y=o("sYmb");function k(e,n){if(1&e){const e=h.Ob();h.Nb(0,"ion-datetime",13),h.Vb("ngModelChange",function(n){return h.jc(e),h.Xb().date=n})("ionChange",function(){return h.jc(e),h.Xb().filter()}),h.Mb()}if(2&e){const e=h.Xb();h.ec("monthNames",e.monthNames),h.dc("max",e.maxDate)("ngModel",e.date)}}function O(e,n){if(1&e&&(h.Nb(0,"ion-select-option",16),h.nc(1),h.Yb(2,"translate"),h.Mb()),2&e){const e=n.$implicit;h.dc("value",e),h.yb(1),h.pc(" ",h.Zb(2,2,"common.sortFields."+e)," ")}}function S(e,n){if(1&e){const e=h.Ob();h.Nb(0,"ion-select",14),h.Vb("ngModelChange",function(n){return h.jc(e),h.Xb().sortField=n})("ionChange",function(){return h.jc(e),h.Xb().filter()}),h.mc(1,O,3,4,"ion-select-option",15),h.Mb()}if(2&e){const e=h.Xb();h.dc("ngModel",e.sortField),h.yb(1),h.dc("ngForOf",e.sortFields)}}function w(e,n){if(1&e&&(h.Nb(0,"ion-select-option",16),h.nc(1),h.Yb(2,"translate"),h.Mb()),2&e){const e=n.$implicit;h.dc("value",e),h.yb(1),h.pc(" ",h.Zb(2,2,"common.sortOrders."+e)," ")}}function Y(e,n){if(1&e){const e=h.Ob();h.Nb(0,"ion-select",14),h.Vb("ngModelChange",function(n){return h.jc(e),h.Xb().sortOrder=n})("ionChange",function(){return h.jc(e),h.Xb().filter()}),h.mc(1,w,3,4,"ion-select-option",15),h.Mb()}if(2&e){const e=h.Xb();h.dc("ngModel",e.sortOrder),h.yb(1),h.dc("ngForOf",e.sortOrders)}}function C(e,n){if(1&e&&(h.Nb(0,"ion-select-option",16),h.nc(1),h.Mb()),2&e){const e=n.$implicit;h.dc("value",e),h.yb(1),h.pc("",e.name," ")}}function v(e,n){if(1&e){const e=h.Ob();h.Nb(0,"ion-select",14),h.Vb("ngModelChange",function(n){return h.jc(e),h.Xb().room=n})("ionChange",function(){return h.jc(e),h.Xb().filter()}),h.mc(1,C,2,2,"ion-select-option",15),h.Mb()}if(2&e){const e=h.Xb();h.dc("ngModel",e.room),h.yb(1),h.dc("ngForOf",e.rooms)}}function j(e,n){if(1&e&&(h.Nb(0,"ion-select-option",16),h.nc(1),h.Yb(2,"translate"),h.Mb()),2&e){const e=n.$implicit;h.dc("value",e),h.yb(1),h.pc(" ",h.Zb(2,2,"common.bookingSteps."+e)," ")}}function F(e,n){if(1&e){const e=h.Ob();h.Nb(0,"ion-select",14),h.Vb("ngModelChange",function(n){return h.jc(e),h.Xb().bookingStep=n})("ionChange",function(){return h.jc(e),h.Xb().filter()}),h.mc(1,j,3,4,"ion-select-option",15),h.Mb()}if(2&e){const e=h.Xb();h.dc("ngModel",e.bookingStep),h.yb(1),h.dc("ngForOf",e.bookingSteps)}}function X(e,n){if(1&e&&(h.Nb(0,"ion-select-option",16),h.nc(1),h.Yb(2,"translate"),h.Mb()),2&e){const e=n.$implicit;h.dc("value",e),h.yb(1),h.pc(" ",h.Zb(2,2,"common.bookingStepExprs."+e)," ")}}function x(e,n){if(1&e){const e=h.Ob();h.Nb(0,"ion-select",17),h.Vb("ngModelChange",function(n){return h.jc(e),h.Xb().bookingStepExpr=n})("ionChange",function(){return h.jc(e),h.Xb().filter()}),h.mc(1,X,3,4,"ion-select-option",15),h.Mb()}if(2&e){const e=h.Xb();h.dc("ngModel",e.bookingStepExpr)("disabled",!e.bookingStep),h.yb(1),h.dc("ngForOf",e.bookingStepExprs)}}function I(e,n){if(1&e){const e=h.Ob();h.Nb(0,"ion-item-options",22),h.Nb(1,"ion-item-option",23),h.Vb("click",function(){h.jc(e);const n=h.Xb().$implicit;return h.Xb().presentAlert(n._id)}),h.Jb(2,"ion-icon",24),h.Mb(),h.Mb()}}function D(e,n){if(1&e){const e=h.Ob();h.Nb(0,"ion-item-options",25),h.Nb(1,"ion-item-option",26),h.Vb("click",function(){h.jc(e);const n=h.Xb().$implicit;return h.Xb().update(n._id)}),h.Jb(2,"ion-icon",27),h.Mb(),h.Mb()}}function Z(e,n){if(1&e){const e=h.Ob();h.Lb(0),h.Nb(1,"ion-item-sliding"),h.Nb(2,"ion-item",18),h.Nb(3,"ion-label"),h.Nb(4,"ion-row"),h.Nb(5,"ion-col",8),h.Nb(6,"ion-item",9),h.Nb(7,"ion-label",10),h.Nb(8,"ion-button",19),h.Vb("click",function(){h.jc(e);const o=n.$implicit;return h.Xb().viewBooking(o._id)}),h.nc(9),h.Yb(10,"translate"),h.Mb(),h.Mb(),h.Mb(),h.Mb(),h.Nb(11,"ion-col",8),h.Nb(12,"ion-item",9),h.Nb(13,"ion-label",10),h.nc(14),h.Yb(15,"date"),h.Mb(),h.Mb(),h.Mb(),h.Nb(16,"ion-col",8),h.Nb(17,"ion-item",9),h.Nb(18,"ion-label",10),h.nc(19),h.Yb(20,"date"),h.Mb(),h.Mb(),h.Mb(),h.Nb(21,"ion-col",8),h.Nb(22,"ion-item",9),h.Nb(23,"ion-label",10),h.Nb(24,"ion-text",11),h.nc(25),h.Mb(),h.Mb(),h.Mb(),h.Mb(),h.Mb(),h.Mb(),h.Mb(),h.mc(26,I,3,0,"ion-item-options",20),h.mc(27,D,3,0,"ion-item-options",21),h.Mb(),h.Kb()}if(2&e){const e=n.$implicit,o=h.Xb();h.yb(8),h.dc("ngClass","status-color_"+e.bookingStep),h.yb(1),h.oc(h.Zb(10,7,"common.bookingSteps."+e.bookingStep)),h.yb(5),h.pc(" ",h.ac(15,9,e.dates.from,"dd MMM")," "),h.yb(5),h.pc(" ",h.ac(20,12,e.dates.to,"dd MMM")," "),h.yb(6),h.pc(" ",e.price," "),h.yb(1),h.dc("ngIf",!(null!=o.user&&o.user.blocked)),h.yb(1),h.dc("ngIf","cancelled"!==e.bookingStep&&!(null!=o.user&&o.user.blocked))}}const E=[{path:"",component:(()=>{class e{constructor(e,n,o,t,i,b){this.sheduleService=e,this.store=n,this.router=o,this.route=t,this.alertController=i,this.translate=b,this.bookingSteps=m.b,this.bookingStep="cancelled",this.bookingStepExprs=m.a,this.bookingStepExpr="$eq",this.sortFields=m.d,this.sortField="dates.from",this.sortOrders=m.e,this.sortOrder=1,this.date=this.sheduleService.convertDateToShort(new Date),this.maxDate=this.sheduleService.convertDateToShort(l.a(new Date,{years:1})),this.updated=!0}ngOnInit(){this.store.select(p.a).subscribe(e=>{if(console.log("company",e),e){const n=this.translate.instant("dif.all");this.rooms=[...e.rooms],this.rooms.unshift({_id:null,name:n}),this.room=this.rooms[0]}},e=>console.log("load rooms err",e)),this.store.select(p.b).subscribe(e=>this.user=e),this.store.select(M.a).subscribe(e=>{this.bookings=e}),this.translate.stream("elements.datePicker.monthNames").subscribe(e=>{this.updated=!1,this.monthNames=e,setTimeout(()=>this.updated=!0,1)}),this.route.url.subscribe(e=>{if(this.room){this.filter(),this.updated=!1;const e=this.translate.instant("dif.all");this.rooms[0].name=e,setTimeout(()=>this.updated=!0,1)}})}ionViewWillEnter(){}presentAlert(e){return Object(c.a)(this,void 0,void 0,function*(){const n=yield this.alertController.create({header:"Delete reservation",subHeader:"Reservation will be deleted",message:"Are you shure?",buttons:[{text:"Cancel",role:"cancel",handler:e=>{}},{text:"Ok",handler:()=>{this.delete(e);const n=this.createBookingQuery();this.store.dispatch(new u.a(n))}}]});yield n.present()})}createBookingQuery(){return{dateRangeLimits:this.sheduleService.createDateRangeLimits(this.sheduleService.convertISOToDate(this.date)),room_id:this.room._id,bookingStep:this.bookingStep?{val:this.bookingStep,expr:this.bookingStepExpr}:null,sort:{field:this.sortField,order:this.sortOrder}}}filter(){const e=this.createBookingQuery();this.store.dispatch(new u.a(e))}getBookings(e,n){return this.store.select(M.a).pipe(Object(g.a)(o=>o.filter(n=>n.room_id===e).map(e=>r.a(new Date(n),new Date(e.dates.from))?Object.assign(Object.assign({},e),{info:"start"}):r.a(new Date(n),new Date(e.dates.to))?Object.assign(Object.assign({},e),{info:"end"}):a.a(new Date(n),new Date(e.dates.from))&&d.a(new Date(n),new Date(e.dates.to))?Object.assign(Object.assign({},e),{info:"ahead"}):void 0).filter(e=>e).sort((e,n)=>new Date(e.dates.from).getTime()-new Date(n.dates.from).getTime()).map(e=>e)))}viewBooking(e){this.router.navigate(["/","shedule","edit",e])}delete(e){this.sheduleService.deleteBooking(e).subscribe(e=>e,e=>console.log("err delete",e))}update(e){this.router.navigateByUrl("/shedule/edit/"+e)}}return e.\u0275fac=function(n){return new(n||e)(h.Ib(f.a),h.Ib(N.i),h.Ib(s.g),h.Ib(s.a),h.Ib(b.a),h.Ib(y.d))},e.\u0275cmp=h.Cb({type:e,selectors:[["app-management"]],decls:82,vars:37,consts:[["slot","end"],["menu","analytics-menu"],["size-md","8","offset-md","2"],["color","primary","lines","none"],["pickerFormat","MMMM-YYYY","displayFormat","MMMM YYYY","placeholder","Select Month",3,"max","monthNames","ngModel","ngModelChange","ionChange",4,"ngIf"],["placeholder","Select One",3,"ngModel","ngModelChange","ionChange",4,"ngIf"],["placeholder","Select One",3,"ngModel","disabled","ngModelChange","ionChange",4,"ngIf"],[1,"ion-no-padding"],["size","3",1,"ion-no-padding"],["lines","none",1,"ion-no-padding"],[1,"ion-text-center"],["color","tertiary"],[4,"ngFor","ngForOf"],["pickerFormat","MMMM-YYYY","displayFormat","MMMM YYYY","placeholder","Select Month",3,"max","monthNames","ngModel","ngModelChange","ionChange"],["placeholder","Select One",3,"ngModel","ngModelChange","ionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["placeholder","Select One",3,"ngModel","disabled","ngModelChange","ionChange"],["lines","none"],["fill","clear",3,"ngClass","click"],["side","end",4,"ngIf"],["side","start",4,"ngIf"],["side","end"],["color","danger",3,"click"],["slot","icon-only","name","trash"],["side","start"],["color","primary",3,"click"],["slot","icon-only","name","pencil-outline"]],template:function(e,n){1&e&&(h.Nb(0,"ion-header"),h.Nb(1,"ion-toolbar"),h.Nb(2,"ion-title"),h.nc(3),h.Yb(4,"translate"),h.Mb(),h.Nb(5,"ion-buttons",0),h.Jb(6,"ion-menu-button",1),h.Mb(),h.Mb(),h.Nb(7,"ion-toolbar"),h.Nb(8,"ion-grid"),h.Nb(9,"ion-row"),h.Nb(10,"ion-col",2),h.Nb(11,"ion-item",3),h.Nb(12,"ion-label"),h.Nb(13,"ion-row"),h.Nb(14,"ion-col"),h.Nb(15,"ion-item"),h.Nb(16,"ion-label"),h.nc(17),h.Yb(18,"translate"),h.Mb(),h.mc(19,k,1,3,"ion-datetime",4),h.Mb(),h.Mb(),h.Nb(20,"ion-col"),h.Nb(21,"ion-item"),h.Nb(22,"ion-label"),h.nc(23),h.Yb(24,"translate"),h.Mb(),h.mc(25,S,2,2,"ion-select",5),h.Mb(),h.Mb(),h.Nb(26,"ion-col"),h.Nb(27,"ion-item"),h.Nb(28,"ion-label"),h.nc(29),h.Yb(30,"translate"),h.Mb(),h.mc(31,Y,2,2,"ion-select",5),h.Mb(),h.Mb(),h.Mb(),h.Nb(32,"ion-row"),h.Nb(33,"ion-col"),h.Nb(34,"ion-item"),h.Nb(35,"ion-label"),h.nc(36,"Room"),h.Mb(),h.mc(37,v,2,2,"ion-select",5),h.Mb(),h.Mb(),h.Nb(38,"ion-col"),h.Nb(39,"ion-item"),h.Nb(40,"ion-label"),h.nc(41),h.Yb(42,"translate"),h.Mb(),h.mc(43,F,2,2,"ion-select",5),h.Mb(),h.Mb(),h.Nb(44,"ion-col"),h.Nb(45,"ion-item"),h.Nb(46,"ion-label"),h.nc(47),h.Yb(48,"translate"),h.Mb(),h.mc(49,x,2,3,"ion-select",6),h.Mb(),h.Mb(),h.Mb(),h.Mb(),h.Mb(),h.Mb(),h.Mb(),h.Mb(),h.Mb(),h.Mb(),h.Nb(50,"ion-content"),h.Nb(51,"ion-grid"),h.Nb(52,"ion-row"),h.Nb(53,"ion-col",2),h.Nb(54,"ion-list"),h.Nb(55,"ion-list-header",7),h.Nb(56,"ion-label"),h.Nb(57,"ion-item"),h.Nb(58,"ion-label"),h.Nb(59,"ion-row"),h.Nb(60,"ion-col",8),h.Nb(61,"ion-item",9),h.Nb(62,"ion-label",10),h.nc(63),h.Yb(64,"translate"),h.Mb(),h.Mb(),h.Mb(),h.Nb(65,"ion-col",8),h.Nb(66,"ion-item",9),h.Nb(67,"ion-label",10),h.nc(68),h.Yb(69,"translate"),h.Mb(),h.Mb(),h.Mb(),h.Nb(70,"ion-col",8),h.Nb(71,"ion-item",9),h.Nb(72,"ion-label",10),h.nc(73),h.Yb(74,"translate"),h.Mb(),h.Mb(),h.Mb(),h.Nb(75,"ion-col",8),h.Nb(76,"ion-item",9),h.Nb(77,"ion-label",10),h.Nb(78,"ion-text",11),h.nc(79),h.Yb(80,"translate"),h.Mb(),h.Mb(),h.Mb(),h.Mb(),h.Mb(),h.Mb(),h.Mb(),h.Mb(),h.Mb(),h.mc(81,Z,28,15,"ng-container",12),h.Mb(),h.Mb(),h.Mb(),h.Mb(),h.Mb()),2&e&&(h.yb(3),h.oc(h.Zb(4,17,"management")),h.yb(14),h.oc(h.Zb(18,19,"elements.datePicker.chooseMonth")),h.yb(2),h.dc("ngIf",n.updated),h.yb(4),h.oc(h.Zb(24,21,"common.sortFields.title")),h.yb(2),h.dc("ngIf",n.updated),h.yb(4),h.oc(h.Zb(30,23,"common.sortOrders.title")),h.yb(2),h.dc("ngIf",n.updated),h.yb(6),h.dc("ngIf",n.updated),h.yb(4),h.oc(h.Zb(42,25,"common.bookingSteps.title")),h.yb(2),h.dc("ngIf",n.updated),h.yb(4),h.oc(h.Zb(48,27,"common.bookingStepExprs.title")),h.yb(2),h.dc("ngIf",n.updated),h.yb(14),h.pc(" ",h.Zb(64,29,"common.bookingSteps.title")," "),h.yb(5),h.pc(" ",h.Zb(69,31,"common.sortFields.dates.from")," "),h.yb(5),h.pc(" ",h.Zb(74,33,"common.sortFields.dates.to")," "),h.yb(6),h.pc(" ",h.Zb(80,35,"common.sortFields.price")," "),h.yb(2),h.dc("ngForOf",n.bookings))},directives:[b.q,b.T,b.R,b.g,b.D,b.p,b.J,b.m,b.t,b.z,t.n,b.n,b.A,b.B,b.Q,t.m,b.o,b.cb,i.k,i.m,b.K,b.L,b.y,b.f,t.l,b.x,b.w,b.r],pipes:[y.c,t.e],styles:["ion-label[_ngcontent-%COMP%]{margin:0}"]}),e})()}];let V=(()=>{class e{}return e.\u0275mod=h.Gb({type:e}),e.\u0275inj=h.Fb({factory:function(n){return new(n||e)},imports:[[s.k.forChild(E)],s.k]}),e})();var $=o("FUS3");let B=(()=>{class e{}return e.\u0275mod=h.Gb({type:e}),e.\u0275inj=h.Fb({factory:function(n){return new(n||e)},imports:[[t.c,i.h,i.n,b.U,V,y.b.forChild({extend:!0}),$.a]]}),e})()}}]);