(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{Fl6X:function(o,e,t){"use strict";t.r(e),t.d(e,"OperatorPageModule",function(){return E});var n=t("ofXK"),r=t("3Pt+"),i=t("TEn/"),b=t("tyNb"),a=t("mrSG"),c=t("mgGq"),s=t("XNiG"),l=t("vkgz"),d=t("eIep"),p=t("JX91"),m=t("pLZG"),u=t("IzEk"),f=t("fXoL"),g=t("d6tv"),N=t("l7P3"),M=t("hlQ1");let h=(()=>{class o extends M.d{constructor(o,e){super("Operator",o),this.userService=e}formFieldOptions(o){return this.formFieldsOptions.get(o)}get formFieldsOptions(){return new Map([["email",{title:"Update email",subTitle:"Email",iconName:"mail-outline",inputLable:"Input email",inputType:"email",errors:new Map([["required","Required value"],["pattern","Entered wrong email"]]),formControl:{formState:"",validatorOrOpts:{updateOn:"blur",validators:[r.o.pattern("^[a-z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{2,4}$"),r.o.required],asyncValidators:[this.userService.checkEmailUnique()]}}}]])}}return o.\u0275fac=function(e){return new(e||o)(f.Rb(M.e),f.Rb(g.a))},o.\u0275prov=f.Eb({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var y=t("1UXS"),O=t("sYmb");const w=["addOperatorFormDirective"];function v(o,e){1&o&&f.Jb(0,"ion-progress-bar",25)}function F(o,e){if(1&o&&(f.Nb(0,"ion-text",27),f.oc(1),f.Yb(2,"translate"),f.Mb()),2&o){const o=e.$implicit;f.yb(1),f.qc(" ",f.Zb(2,1,"errors."+o)," ")}}function k(o,e){if(1&o&&(f.Lb(0),f.nc(1,F,3,3,"ion-text",26),f.Yb(2,"errorExtractor"),f.Kb()),2&o){const o=f.Xb(2);f.yb(1),f.dc("ngForOf",f.Zb(2,1,o.addOperatorForm.get("login").errors))}}function I(o,e){if(1&o&&(f.Nb(0,"ion-text",27),f.oc(1),f.Yb(2,"translate"),f.Mb()),2&o){const o=e.$implicit;f.yb(1),f.qc(" ",f.Zb(2,1,"errors."+o)," ")}}function x(o,e){if(1&o&&(f.Lb(0),f.nc(1,I,3,3,"ion-text",26),f.Yb(2,"errorExtractor"),f.Kb()),2&o){const o=f.Xb(2);f.yb(1),f.dc("ngForOf",f.Zb(2,1,o.addOperatorForm.get("email").errors))}}function C(o,e){if(1&o&&(f.Nb(0,"ion-text",27),f.oc(1),f.Yb(2,"translate"),f.Mb()),2&o){const o=e.$implicit;f.yb(1),f.qc(" ",f.Zb(2,1,"errors."+o)," ")}}function S(o,e){if(1&o&&(f.Lb(0),f.nc(1,C,3,3,"ion-text",26),f.Yb(2,"errorExtractor"),f.Kb()),2&o){const o=f.Xb(2);f.yb(1),f.dc("ngForOf",f.Zb(2,1,o.addOperatorForm.get("password").errors))}}function Z(o,e){1&o&&f.Jb(0,"ion-icon",28),2&o&&f.dc("name","checkmark-done-outline")}function $(o,e){if(1&o&&(f.Nb(0,"ion-text",27),f.oc(1),f.Yb(2,"translate"),f.Mb()),2&o){const o=e.$implicit;f.yb(1),f.qc(" ",f.Zb(2,1,"errors."+o)," ")}}function q(o,e){if(1&o&&(f.Lb(0),f.nc(1,$,3,3,"ion-text",26),f.Yb(2,"errorExtractor"),f.Kb()),2&o){const o=f.Xb(2);f.yb(1),f.dc("ngForOf",f.Zb(2,1,o.addOperatorForm.get("passwordConfirm").errors))}}function X(o,e){if(1&o){const o=f.Ob();f.Nb(0,"form",3,4),f.Nb(2,"ion-grid"),f.Nb(3,"ion-row"),f.Nb(4,"ion-col",5),f.Nb(5,"ion-card"),f.Nb(6,"ion-card-header"),f.Nb(7,"ion-card-title",6),f.oc(8,"Add company user"),f.Mb(),f.nc(9,v,1,0,"ion-progress-bar",7),f.Yb(10,"async"),f.Mb(),f.Nb(11,"ion-card-content"),f.Nb(12,"ion-list"),f.Nb(13,"ion-item"),f.Jb(14,"ion-icon",8),f.Nb(15,"ion-label",9),f.oc(16,"Login"),f.Mb(),f.Jb(17,"ion-input",10),f.Mb(),f.nc(18,k,3,3,"ng-container",11),f.Nb(19,"ion-item"),f.Jb(20,"ion-icon",12),f.Nb(21,"ion-label",9),f.oc(22,"Email"),f.Mb(),f.Jb(23,"ion-input",13),f.Mb(),f.nc(24,x,3,3,"ng-container",11),f.Nb(25,"ion-item",14),f.Jb(26,"ion-icon",15),f.Nb(27,"ion-label",9),f.oc(28,"Password"),f.Mb(),f.Jb(29,"ion-input",16),f.Nb(30,"ion-icon",17),f.Vb("click",function(){return f.kc(o),f.Xb().switchInputType()}),f.Mb(),f.Mb(),f.nc(31,S,3,3,"ng-container",11),f.Nb(32,"ion-item",14),f.Jb(33,"ion-icon",18),f.Nb(34,"ion-label",9),f.oc(35,"Password Confirm"),f.Mb(),f.Jb(36,"ion-input",19),f.nc(37,Z,1,1,"ion-icon",20),f.Mb(),f.nc(38,q,3,3,"ng-container",11),f.Mb(),f.Mb(),f.Mb(),f.Nb(39,"ion-row"),f.Nb(40,"ion-col",21),f.Nb(41,"ion-button",22),f.Vb("click",function(){return f.kc(o),f.Xb().dismiss()}),f.oc(42,"Cancel"),f.Mb(),f.Mb(),f.Nb(43,"ion-col",23),f.Nb(44,"ion-button",24),f.Vb("click",function(){return f.kc(o),f.Xb().formSubmitSubject$.next()}),f.oc(45," Add "),f.Mb(),f.Mb(),f.Mb(),f.Mb(),f.Mb(),f.Mb(),f.Mb()}if(2&o){const o=f.Xb();f.dc("formGroup",o.addOperatorForm),f.yb(9),f.dc("ngIf",f.Zb(10,11,o.loading$)),f.yb(9),f.dc("ngIf",o.addOperatorForm.get("login").dirty&&o.addOperatorForm.get("login").errors),f.yb(6),f.dc("ngIf",o.addOperatorForm.get("email").dirty&&o.addOperatorForm.get("email").errors),f.yb(5),f.dc("type",o.inputType),f.yb(1),f.dc("name","password"===o.inputType?"eye-outline":"eye-off-outline"),f.yb(1),f.dc("ngIf",o.addOperatorForm.get("password").dirty&&o.addOperatorForm.get("password").errors),f.yb(5),f.dc("type",o.inputType),f.yb(1),f.dc("ngIf","VALID"===o.addOperatorForm.get("passwordConfirm").status),f.yb(1),f.dc("ngIf",o.addOperatorForm.get("passwordConfirm").dirty&&o.addOperatorForm.get("passwordConfirm").errors),f.yb(6),f.dc("disabled","INVALID"===o.addOperatorForm.status||"PENDING"===o.addOperatorForm.status)}}let Y=(()=>{class o{constructor(o,e,t,n){this.modalController=o,this.userService=e,this.store=t,this.operatorService=n,this.inputType="password",this.formSubmitSubject$=new s.a}ngOnInit(){this.loading$=this.operatorService.loading$,this.addOperatorForm=new r.e({login:new r.c("",{updateOn:"change",validators:[r.o.pattern("^[a-zA-Z0-9_\\-]+$"),r.o.minLength(2),r.o.maxLength(60),r.o.required],asyncValidators:[this.userService.checkLoginUnique()]}),password:new r.c("",{updateOn:"change",validators:[r.o.pattern("^[a-zA-Z0-9_\\-]+$"),r.o.minLength(8),r.o.maxLength(60),r.o.required]}),passwordConfirm:new r.c("",{updateOn:"change",validators:[r.o.pattern("^[a-zA-Z0-9_\\-]+$"),r.o.minLength(8),r.o.maxLength(60),r.o.required]}),email:this.userService.emailFormControl()},this.userService.matchPassword),this.formSubmitSubject$.pipe(Object(l.a)(()=>this.addOperatorForm.markAsDirty()),Object(d.a)(()=>this.addOperatorForm.statusChanges.pipe(Object(p.a)(this.addOperatorForm.status),Object(m.a)(o=>"PENDING"!==o),Object(u.a)(1))),Object(m.a)(o=>"VALID"===o)).subscribe(o=>this.onSignup())}dismiss(o){this.modalController.dismiss(o)}switchInputType(){this.inputType="password"===this.inputType?"text":"password"}onSignup(){this.dismiss({login:this.addOperatorForm.get("login").value,password:this.addOperatorForm.get("password").value,email:this.addOperatorForm.get("email").value}),this.resetForm()}resetForm(){this.addOperatorFormDirective&&this.addOperatorFormDirective.resetForm()}}return o.\u0275fac=function(e){return new(e||o)(f.Ib(i.X),f.Ib(g.a),f.Ib(N.i),f.Ib(h))},o.\u0275cmp=f.Cb({type:o,selectors:[["app-operator-add"]],viewQuery:function(o,e){var t;1&o&&f.sc(w,!0),2&o&&f.ic(t=f.Wb())&&(e.addOperatorFormDirective=t.first)},inputs:{company:"company"},decls:9,vars:1,consts:[["slot","end"],[3,"click"],[3,"formGroup",4,"ngIf"],[3,"formGroup"],["addOperatorFormDirective","ngForm"],["size-md","10","offset-md","1"],[1,"ion-text-center"],["type","indeterminate","color","primary",4,"ngIf"],["name","person-outline","slot","start",1,"ion-align-self-center"],["position","floating"],["type","text","autocomplete","","autocorrect","","formControlName","login"],[4,"ngIf"],["name","mail-outline","slot","start",1,"ion-align-self-center"],["type","email","autocomplete","","autocorrect","","formControlName","email"],["lines","none"],["name","lock-closed-outline","slot","start",1,"ion-align-self-center"],["autocomplete","","autocorrect","","formControlName","password",3,"type"],["slot","end",1,"ion-align-self-center",3,"name","click"],["name","reorder-two-outline","slot","start",1,"ion-align-self-center"],["autocomplete","","autocorrect","","formControlName","passwordConfirm",3,"type"],["class","ion-align-self-center","color","primary","slot","end",3,"name",4,"ngIf"],["size","8"],["expand","block","fill","outline",3,"click"],["size","4"],["expand","block",3,"disabled","click"],["type","indeterminate","color","primary"],["class","input-error","color","danger",4,"ngFor","ngForOf"],["color","danger",1,"input-error"],["color","primary","slot","end",1,"ion-align-self-center",3,"name"]],template:function(o,e){1&o&&(f.Nb(0,"ion-header"),f.Nb(1,"ion-toolbar"),f.Nb(2,"ion-title"),f.oc(3,"Add company user"),f.Mb(),f.Nb(4,"ion-buttons",0),f.Nb(5,"ion-button",1),f.Vb("click",function(){return e.dismiss()}),f.oc(6,"close"),f.Mb(),f.Mb(),f.Mb(),f.Mb(),f.Nb(7,"ion-content"),f.nc(8,X,46,13,"form",2),f.Mb()),2&o&&(f.yb(8),f.dc("ngIf",e.addOperatorForm))},directives:[i.q,i.T,i.R,i.g,i.f,i.n,n.n,r.p,r.l,r.f,i.p,i.J,i.m,i.h,i.j,i.l,i.i,i.A,i.t,i.r,i.z,i.s,i.db,r.k,r.d,i.G,n.m,i.Q],pipes:[n.b,y.a,O.c],styles:[""]}),o})();function L(o,e){1&o&&(f.Lb(0),f.oc(1," Loading.."),f.Kb())}function J(o,e){if(1&o){const o=f.Ob();f.Nb(0,"ion-item-sliding"),f.Nb(1,"ion-item"),f.Nb(2,"ion-label"),f.Nb(3,"ion-row"),f.Nb(4,"ion-col",7),f.Nb(5,"ion-item",8),f.Nb(6,"ion-label"),f.Nb(7,"h4"),f.oc(8),f.Yb(9,"translate"),f.Mb(),f.Mb(),f.Mb(),f.Mb(),f.Nb(10,"ion-col",9),f.Nb(11,"ion-item",8),f.Nb(12,"ion-label"),f.Nb(13,"ion-text",10),f.Nb(14,"p"),f.oc(15),f.Mb(),f.Mb(),f.Mb(),f.Mb(),f.Mb(),f.Mb(),f.Nb(16,"ion-row"),f.Nb(17,"ion-col",7),f.Nb(18,"ion-item",8),f.Nb(19,"ion-label"),f.Nb(20,"h4"),f.oc(21),f.Yb(22,"translate"),f.Mb(),f.Mb(),f.Mb(),f.Mb(),f.Nb(23,"ion-col",9),f.Nb(24,"ion-item",8),f.Nb(25,"ion-label"),f.Nb(26,"ion-text",10),f.Nb(27,"p"),f.oc(28),f.Mb(),f.Mb(),f.Mb(),f.Mb(),f.Mb(),f.Mb(),f.Nb(29,"ion-row"),f.Nb(30,"ion-col",7),f.Nb(31,"ion-item",8),f.Nb(32,"ion-label"),f.Nb(33,"h4"),f.oc(34),f.Yb(35,"translate"),f.Mb(),f.Mb(),f.Mb(),f.Mb(),f.Nb(36,"ion-col",9),f.Nb(37,"ion-item",8),f.Nb(38,"ion-label"),f.Nb(39,"ion-text",10),f.Nb(40,"p"),f.oc(41),f.Mb(),f.Mb(),f.Mb(),f.Mb(),f.Mb(),f.Mb(),f.Nb(42,"ion-row"),f.Nb(43,"ion-col",7),f.Nb(44,"ion-item",8),f.Nb(45,"ion-label"),f.Nb(46,"h4"),f.oc(47),f.Yb(48,"translate"),f.Mb(),f.Mb(),f.Mb(),f.Mb(),f.Nb(49,"ion-col",9),f.Nb(50,"ion-item",8),f.Nb(51,"ion-label"),f.Nb(52,"ion-text",10),f.Nb(53,"p"),f.oc(54),f.Yb(55,"translate"),f.Mb(),f.Mb(),f.Mb(),f.Nb(56,"ion-button",5),f.Vb("click",function(){f.kc(o);const e=f.Xb().$implicit;return f.Xb().blockUser(e._id,!e.blocked)}),f.oc(57),f.Yb(58,"translate"),f.Mb(),f.Mb(),f.Mb(),f.Mb(),f.Nb(59,"ion-row"),f.Nb(60,"ion-col",7),f.Nb(61,"ion-item",8),f.Nb(62,"ion-label"),f.Nb(63,"h4"),f.oc(64),f.Yb(65,"translate"),f.Mb(),f.Mb(),f.Mb(),f.Mb(),f.Nb(66,"ion-col",9),f.Nb(67,"ion-item",8),f.Nb(68,"ion-label"),f.Nb(69,"ion-text",10),f.Nb(70,"p"),f.oc(71),f.Yb(72,"translate"),f.Mb(),f.Mb(),f.Mb(),f.Mb(),f.Mb(),f.Mb(),f.Mb(),f.Mb(),f.Nb(73,"ion-item-options",11),f.Nb(74,"ion-item-option",12),f.Vb("click",function(){f.kc(o);const e=f.Xb().$implicit;return f.Xb().presentAlert(e._id,e.login)}),f.Jb(75,"ion-icon",13),f.Mb(),f.Mb(),f.Mb()}if(2&o){const o=f.Xb().$implicit;f.yb(8),f.pc(f.Zb(9,11,"modules.dashboard.profile.login")),f.yb(7),f.qc(" ",o.login," "),f.yb(6),f.pc(f.Zb(22,13,"modules.dashboard.profile.email")),f.yb(7),f.qc(" ",o.email," "),f.yb(6),f.pc(f.Zb(35,15,"modules.dashboard.profile.role")),f.yb(7),f.qc(" ",o.role," "),f.yb(6),f.pc(f.Zb(48,17,"modules.dashboard.profile.blocked")),f.yb(7),f.qc(" ",f.Zb(55,19,"common.logic."+!!o.blocked)," "),f.yb(3),f.qc(" ",f.Zb(58,21,o.blocked?"modules.dashboard.operator.unblock":"modules.dashboard.operator.block")," "),f.yb(7),f.pc(f.Zb(65,23,"modules.dashboard.profile.activated")),f.yb(7),f.qc(" ",f.Zb(72,25,"common.logic."+!!o.activated)," ")}}function z(o,e){if(1&o&&(f.Lb(0),f.nc(1,J,76,27,"ion-item-sliding",0),f.Kb()),2&o){const o=e.$implicit,t=f.Xb();f.yb(1),f.dc("ngIf",o._id!==t.user._id)}}const A=[{path:"",component:(()=>{class o{constructor(o,e,t,n){this.operatorService=o,this.store=e,this.modalController=t,this.alertController=n,this.user=null,this.company=null}ngOnInit(){this.store.select(c.a).subscribe(o=>{o&&(this.company=o,this.operatorService.getAll())}),this.store.select(c.b).subscribe(o=>{o&&(this.user=o)}),this.entities$=this.operatorService.entities$,this.loading$=this.operatorService.loading$,this.entities$.subscribe(o=>this.operators=o)}presentAlert(o,e){return Object(a.a)(this,void 0,void 0,function*(){const t=yield this.alertController.create({header:"Delete",subHeader:"user with login: "+e,message:"Are you shure?",buttons:[{text:"Cancel",role:"cancel",handler:o=>{console.log("Confirm Cancel: blah")}},{text:"Okay",handler:()=>this.remove(o)}]});yield t.present()})}presentModal(o,e){return Object(a.a)(this,void 0,void 0,function*(){const t=yield this.modalController.create({component:o,componentProps:e});return yield t.present(),yield t.onWillDismiss()})}blockUser(o,e){this.operatorService.update({_id:o,blocked:e}).subscribe(o=>console.log("update result",o),o=>console.log("update error",o))}add(){return Object(a.a)(this,void 0,void 0,function*(){const{data:o}=yield this.presentModal(Y,{company:this.company});o&&this.operatorService.add(o).subscribe(o=>console.log("add result",o),o=>console.log("add error",o))})}remove(o){return this.operatorService.delete(o)}}return o.\u0275fac=function(e){return new(e||o)(f.Ib(h),f.Ib(N.i),f.Ib(i.X),f.Ib(i.a))},o.\u0275cmp=f.Cb({type:o,selectors:[["app-operator"]],decls:25,vars:14,consts:[[4,"ngIf"],["slot","end"],["menu","dashboard-menu"],["size-md","6","offset-md","3"],[1,"ion-text-center"],[3,"click"],[4,"ngFor","ngForOf"],["size","4",1,"ion-no-padding"],["lines","none",1,"ion-no-padding"],["size","8",1,"ion-no-padding"],["color","primary"],["side","end"],["color","danger",3,"click"],["slot","icon-only","name","trash"]],template:function(o,e){1&o&&(f.Nb(0,"ion-header"),f.Nb(1,"ion-toolbar"),f.Nb(2,"ion-title"),f.oc(3),f.Yb(4,"translate"),f.nc(5,L,2,0,"ng-container",0),f.Yb(6,"async"),f.Mb(),f.Nb(7,"ion-buttons",1),f.Jb(8,"ion-menu-button",2),f.Mb(),f.Mb(),f.Mb(),f.Nb(9,"ion-content"),f.Nb(10,"ion-grid"),f.Nb(11,"ion-row"),f.Nb(12,"ion-col",3),f.Nb(13,"h2",4),f.oc(14),f.Mb(),f.Nb(15,"ion-list"),f.Nb(16,"ion-list-header"),f.Nb(17,"ion-label"),f.Nb(18,"ion-note",1),f.oc(19),f.Yb(20,"translate"),f.Mb(),f.Mb(),f.Nb(21,"ion-button",5),f.Vb("click",function(){return e.add()}),f.oc(22),f.Yb(23,"translate"),f.Mb(),f.Mb(),f.nc(24,z,2,1,"ng-container",6),f.Mb(),f.Mb(),f.Mb(),f.Mb(),f.Mb()),2&o&&(f.yb(3),f.qc("",f.Zb(4,6,"modules.dashboard.operator.title")," "),f.yb(2),f.dc("ngIf",f.Zb(6,8,e.loading$)),f.yb(9),f.pc(null==e.company?null:e.company.companyName),f.yb(5),f.qc(" ",f.Zb(20,10,"elements.button.slideToDelete")," "),f.yb(3),f.pc(f.Zb(23,12,"elements.button.add")),f.yb(2),f.dc("ngForOf",e.operators))},directives:[i.q,i.T,i.R,n.n,i.g,i.D,i.n,i.p,i.J,i.m,i.A,i.B,i.z,i.F,i.f,n.m,i.y,i.t,i.Q,i.x,i.w,i.r],pipes:[O.c,n.b],styles:[""]}),o})()}];let j=(()=>{class o{}return o.\u0275mod=f.Gb({type:o}),o.\u0275inj=f.Fb({factory:function(e){return new(e||o)},imports:[[b.k.forChild(A)],b.k]}),o})();var D=t("FpXt"),T=t("iTUp");let E=(()=>{class o{}return o.\u0275mod=f.Gb({type:o}),o.\u0275inj=f.Fb({factory:function(e){return new(e||o)},imports:[[n.c,r.h,i.U,r.n,j,D.a,O.b.forChild({extend:!0}),T.a]]}),o})()}}]);