!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function n(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function r(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,o=a(e);if(t){var r=a(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return i(this,n)}}function i(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{Fl6X:function(t,i,a){"use strict";a.r(i),a.d(i,"OperatorPageModule",function(){return V});var c,b=a("ofXK"),s=a("3Pt+"),l=a("TEn/"),u=a("tyNb"),d=a("mrSG"),p=a("mgGq"),m=a("vtsq"),f=a("XNiG"),h=a("vkgz"),g=a("eIep"),N=a("JX91"),y=a("pLZG"),M=a("IzEk"),v=a("fXoL"),w=a("d6tv"),O=a("l7P3"),k=a("hlQ1"),F=((c=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(a,t);var i=r(a);function a(t,n){var o;return e(this,a),(o=i.call(this,"Operator",t)).userService=n,o}return n(a,[{key:"formFieldOptions",value:function(e){return this.formFieldsOptions.get(e)}},{key:"formFieldsOptions",get:function(){return new Map([["email",{title:"Update email",subTitle:"Email",iconName:"mail-outline",inputLable:"Input email",inputType:"email",errors:new Map([["required","Required value"],["pattern","Entered wrong email"]]),formControl:{formState:"",validatorOrOpts:{updateOn:"blur",validators:[s.o.pattern("^[a-z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{2,4}$"),s.o.required],asyncValidators:[this.userService.checkEmailUnique()]}}}]])}}]),a}(k.d)).\u0275fac=function(e){return new(e||c)(v.Rb(k.e),v.Rb(w.a))},c.\u0275prov=v.Eb({token:c,factory:c.\u0275fac,providedIn:"root"}),c),x=["addOperatorFormDirective"];function I(e,t){1&e&&v.Jb(0,"ion-progress-bar",22)}function S(e,t){if(1&e&&(v.Nb(0,"ion-text",23),v.lc(1),v.Yb(2,"json"),v.Mb()),2&e){var n=v.Xb(2);v.yb(1),v.nc(" ",v.Zb(2,1,n.addOperatorForm.get("login").errors)," ")}}function C(e,t){if(1&e&&(v.Nb(0,"ion-text",23),v.lc(1),v.Yb(2,"json"),v.Mb()),2&e){var n=v.Xb(2);v.yb(1),v.nc(" ",v.Zb(2,1,n.addOperatorForm.get("email").errors)," ")}}function j(e,t){if(1&e&&(v.Nb(0,"ion-text",23),v.lc(1),v.Yb(2,"json"),v.Mb()),2&e){var n=v.Xb(2);v.yb(1),v.nc(" ",v.Zb(2,1,n.addOperatorForm.get("password").errors)," ")}}function X(e,t){1&e&&v.Jb(0,"ion-icon",24),2&e&&v.dc("name","checkmark-done-outline")}function $(e,t){if(1&e&&(v.Nb(0,"ion-text",23),v.lc(1),v.Yb(2,"json"),v.Mb()),2&e){var n=v.Xb(2);v.yb(1),v.nc(" ",v.Zb(2,1,n.addOperatorForm.get("passwordConfirm").errors)," ")}}function R(e,t){if(1&e){var n=v.Ob();v.Nb(0,"form",3,4),v.Nb(2,"ion-grid"),v.Nb(3,"ion-row"),v.Nb(4,"ion-col",5),v.Nb(5,"ion-card"),v.Nb(6,"ion-card-header"),v.Nb(7,"ion-card-title",6),v.lc(8,"Add company user"),v.Mb(),v.kc(9,I,1,0,"ion-progress-bar",7),v.Yb(10,"async"),v.Mb(),v.Nb(11,"ion-card-content"),v.Nb(12,"ion-list"),v.Nb(13,"ion-item"),v.Jb(14,"ion-icon",8),v.Nb(15,"ion-label",9),v.lc(16,"Login"),v.Mb(),v.Jb(17,"ion-input",10),v.Mb(),v.kc(18,S,3,3,"ion-text",11),v.Nb(19,"ion-item"),v.Jb(20,"ion-icon",12),v.Nb(21,"ion-label",9),v.lc(22,"Email"),v.Mb(),v.Jb(23,"ion-input",13),v.Mb(),v.kc(24,C,3,3,"ion-text",11),v.Nb(25,"ion-item",14),v.Jb(26,"ion-icon",15),v.Nb(27,"ion-label",9),v.lc(28,"Password"),v.Mb(),v.Jb(29,"ion-input",16),v.Nb(30,"ion-icon",17),v.Vb("click",function(){return v.hc(n),v.Xb().switchInputType()}),v.Mb(),v.Mb(),v.kc(31,j,3,3,"ion-text",11),v.Nb(32,"ion-item",14),v.Jb(33,"ion-icon",18),v.Nb(34,"ion-label",9),v.lc(35,"Password Confirm"),v.Mb(),v.Jb(36,"ion-input",19),v.kc(37,X,1,1,"ion-icon",20),v.Mb(),v.kc(38,$,3,3,"ion-text",11),v.Mb(),v.Mb(),v.Mb(),v.Nb(39,"ion-row"),v.Nb(40,"ion-col"),v.Nb(41,"ion-button",21),v.Vb("click",function(){return v.hc(n),v.Xb().formSubmitSubject$.next()}),v.lc(42," Signup "),v.Mb(),v.Mb(),v.Mb(),v.Mb(),v.Mb(),v.Mb(),v.Mb()}if(2&e){var o=v.Xb();v.dc("formGroup",o.addOperatorForm),v.yb(9),v.dc("ngIf",v.Zb(10,11,o.loading$)),v.yb(9),v.dc("ngIf",o.addOperatorForm.get("login").touched&&o.addOperatorForm.get("login").errors),v.yb(6),v.dc("ngIf",o.addOperatorForm.get("email").touched&&o.addOperatorForm.get("email").errors),v.yb(5),v.dc("type",o.inputType),v.yb(1),v.dc("name","password"===o.inputType?"eye-outline":"eye-off-outline"),v.yb(1),v.dc("ngIf",o.addOperatorForm.get("password").touched&&o.addOperatorForm.get("password").errors),v.yb(5),v.dc("type",o.inputType),v.yb(1),v.dc("ngIf","VALID"===o.addOperatorForm.get("passwordConfirm").status),v.yb(1),v.dc("ngIf",o.addOperatorForm.get("passwordConfirm").touched&&o.addOperatorForm.get("passwordConfirm").errors),v.yb(3),v.dc("disabled","INVALID"===o.addOperatorForm.status||"PENDING"===o.addOperatorForm.status)}}var _,L=((_=function(){function t(n,o,r,i){e(this,t),this.modalController=n,this.userService=o,this.store=r,this.operatorService=i,this.inputType="password",this.formSubmitSubject$=new f.a}return n(t,[{key:"ngOnInit",value:function(){var e=this;this.loading$=this.operatorService.loading$,this.addOperatorForm=new s.e({login:new s.c("",{updateOn:"blur",validators:[s.o.pattern("^[a-zA-Z0-9_\\-]{2,60}$"),s.o.minLength(2),s.o.maxLength(60),s.o.required],asyncValidators:[this.userService.checkLoginUnique()]}),password:new s.c("",{updateOn:"change",validators:[s.o.pattern("^[a-zA-Z0-9_\\-]{8,60}$"),s.o.minLength(8),s.o.maxLength(60),s.o.required]}),passwordConfirm:new s.c("",{updateOn:"change",validators:[s.o.pattern("^[a-zA-Z0-9_\\-]{8,60}$"),s.o.minLength(8),s.o.maxLength(60),s.o.required]}),email:this.userService.emailFormControl()},this.userService.matchPassword),this.formSubmitSubject$.pipe(Object(h.a)(function(){return e.addOperatorForm.markAsDirty()}),Object(g.a)(function(){return e.addOperatorForm.statusChanges.pipe(Object(N.a)(e.addOperatorForm.status),Object(y.a)(function(e){return"PENDING"!==e}),Object(M.a)(1))}),Object(y.a)(function(e){return"VALID"===e})).subscribe(function(t){return e.onSignup()})}},{key:"dismiss",value:function(e){this.modalController.dismiss(e)}},{key:"switchInputType",value:function(){this.inputType="password"===this.inputType?"text":"password"}},{key:"onSignup",value:function(){this.dismiss({login:this.addOperatorForm.get("login").value,password:this.addOperatorForm.get("password").value,email:this.addOperatorForm.get("email").value}),this.resetForm()}},{key:"resetForm",value:function(){this.addOperatorFormDirective&&this.addOperatorFormDirective.resetForm()}}]),t}()).\u0275fac=function(e){return new(e||_)(v.Ib(l.R),v.Ib(w.a),v.Ib(O.i),v.Ib(F))},_.\u0275cmp=v.Cb({type:_,selectors:[["app-operator-add"]],viewQuery:function(e,t){var n;1&e&&v.pc(x,!0),2&e&&v.gc(n=v.Wb())&&(t.addOperatorFormDirective=n.first)},inputs:{company:"company"},decls:9,vars:1,consts:[["slot","end"],[3,"click"],[3,"formGroup",4,"ngIf"],[3,"formGroup"],["addOperatorFormDirective","ngForm"],["size-md","10","offset-md","1"],[1,"ion-text-center"],["type","indeterminate","color","primary",4,"ngIf"],["name","person-outline","slot","start",1,"ion-align-self-center"],["position","floating"],["type","text","autocomplete","","autocorrect","","formControlName","login"],["class","input-error","color","danger",4,"ngIf"],["name","mail-outline","slot","start",1,"ion-align-self-center"],["type","email","autocomplete","","autocorrect","","formControlName","email"],["lines","none"],["name","lock-closed-outline","slot","start",1,"ion-align-self-center"],["autocomplete","","autocorrect","","formControlName","password",3,"type"],["slot","end",1,"ion-align-self-center",3,"name","click"],["name","reorder-two-outline","slot","start",1,"ion-align-self-center"],["autocomplete","","autocorrect","","formControlName","passwordConfirm",3,"type"],["class","ion-align-self-center","color","primary","slot","end",3,"name",4,"ngIf"],["expand","block",3,"disabled","click"],["type","indeterminate","color","primary"],["color","danger",1,"input-error"],["color","primary","slot","end",1,"ion-align-self-center",3,"name"]],template:function(e,t){1&e&&(v.Nb(0,"ion-header"),v.Nb(1,"ion-toolbar"),v.Nb(2,"ion-title"),v.lc(3,"Add company user"),v.Mb(),v.Nb(4,"ion-buttons",0),v.Nb(5,"ion-button",1),v.Vb("click",function(){return t.dismiss()}),v.lc(6,"close"),v.Mb(),v.Mb(),v.Mb(),v.Mb(),v.Nb(7,"ion-content"),v.kc(8,R,43,13,"form",2),v.Mb()),2&e&&(v.yb(8),v.dc("ngIf",t.addOperatorForm))},directives:[l.p,l.O,l.N,l.f,l.e,l.m,b.n,s.p,s.l,s.f,l.o,l.G,l.l,l.g,l.i,l.k,l.h,l.x,l.s,l.q,l.w,l.r,l.X,s.k,s.d,l.D,l.M],pipes:[b.b,b.g],styles:[""]}),_);function P(e,t){1&e&&(v.Lb(0),v.lc(1," Loading.."),v.Kb())}function D(e,t){if(1&e){var n=v.Ob();v.Nb(0,"ion-item-sliding"),v.Nb(1,"ion-item"),v.Nb(2,"ion-label"),v.Nb(3,"ion-row"),v.Nb(4,"ion-col",7),v.Nb(5,"ion-item",8),v.Nb(6,"ion-label"),v.Nb(7,"h4"),v.lc(8,"Login:"),v.Mb(),v.Mb(),v.Mb(),v.Mb(),v.Nb(9,"ion-col",9),v.Nb(10,"ion-item",8),v.Nb(11,"ion-label"),v.Nb(12,"ion-text",10),v.Nb(13,"p"),v.lc(14),v.Mb(),v.Mb(),v.Mb(),v.Mb(),v.Mb(),v.Mb(),v.Nb(15,"ion-row"),v.Nb(16,"ion-col",7),v.Nb(17,"ion-item",8),v.Nb(18,"ion-label"),v.Nb(19,"h4"),v.lc(20,"Email:"),v.Mb(),v.Mb(),v.Mb(),v.Mb(),v.Nb(21,"ion-col",9),v.Nb(22,"ion-item",8),v.Nb(23,"ion-label"),v.Nb(24,"ion-text",10),v.Nb(25,"p"),v.lc(26),v.Mb(),v.Mb(),v.Mb(),v.Nb(27,"ion-button",5),v.Vb("click",function(){v.hc(n);var e=v.Xb().$implicit;return v.Xb().update(e._id,"email")}),v.lc(28," Update "),v.Mb(),v.Mb(),v.Mb(),v.Mb(),v.Nb(29,"ion-row"),v.Nb(30,"ion-col",7),v.Nb(31,"ion-item",8),v.Nb(32,"ion-label"),v.Nb(33,"h4"),v.lc(34,"Role:"),v.Mb(),v.Mb(),v.Mb(),v.Mb(),v.Nb(35,"ion-col",9),v.Nb(36,"ion-item",8),v.Nb(37,"ion-label"),v.Nb(38,"ion-text",10),v.Nb(39,"p"),v.lc(40),v.Mb(),v.Mb(),v.Mb(),v.Mb(),v.Mb(),v.Mb(),v.Nb(41,"ion-row"),v.Nb(42,"ion-col",7),v.Nb(43,"ion-item",8),v.Nb(44,"ion-label"),v.Nb(45,"h4"),v.lc(46,"Blocked:"),v.Mb(),v.Mb(),v.Mb(),v.Mb(),v.Nb(47,"ion-col",9),v.Nb(48,"ion-item",8),v.Nb(49,"ion-label"),v.Nb(50,"ion-text",10),v.Nb(51,"p"),v.lc(52),v.Mb(),v.Mb(),v.Mb(),v.Nb(53,"ion-button",5),v.Vb("click",function(){v.hc(n);var e=v.Xb().$implicit;return v.Xb().blockUser(e._id,!e.blocked)}),v.lc(54),v.Mb(),v.Mb(),v.Mb(),v.Mb(),v.Nb(55,"ion-row"),v.Nb(56,"ion-col",7),v.Nb(57,"ion-item",8),v.Nb(58,"ion-label"),v.Nb(59,"h4"),v.lc(60,"Activated:"),v.Mb(),v.Mb(),v.Mb(),v.Mb(),v.Nb(61,"ion-col",9),v.Nb(62,"ion-item",8),v.Nb(63,"ion-label"),v.Nb(64,"ion-text",10),v.Nb(65,"p"),v.lc(66),v.Mb(),v.Mb(),v.Mb(),v.Nb(67,"ion-note",1),v.lc(68," slide to delete "),v.Mb(),v.Mb(),v.Mb(),v.Mb(),v.Mb(),v.Mb(),v.Nb(69,"ion-item-options",11),v.Nb(70,"ion-item-option",12),v.Vb("click",function(){v.hc(n);var e=v.Xb().$implicit;return v.Xb().presentAlert(e._id,e.login)}),v.Jb(71,"ion-icon",13),v.Mb(),v.Mb(),v.Mb()}if(2&e){var o=v.Xb().$implicit;v.yb(14),v.nc(" ",o.login," "),v.yb(12),v.nc(" ",o.email," "),v.yb(14),v.nc(" ",o.role," "),v.yb(12),v.nc(" ",!!o.blocked," "),v.yb(2),v.nc(" ",o.blocked?"Unblock":"Block"," "),v.yb(12),v.nc(" ",!!o.activated," ")}}function A(e,t){if(1&e&&(v.Lb(0),v.kc(1,D,72,6,"ion-item-sliding",0),v.Kb()),2&e){var n=t.$implicit,o=v.Xb();v.yb(1),v.dc("ngIf",n._id!==o.user._id)}}var J,E,G,T=[{path:"",component:(J=function(){function t(n,o,r,i){e(this,t),this.operatorService=n,this.store=o,this.modalController=r,this.alertController=i,this.user=null,this.company=null}return n(t,[{key:"ngOnInit",value:function(){var e=this;this.store.select(p.a).subscribe(function(t){t&&(e.company=t,e.operatorService.getAll())}),this.store.select(p.b).subscribe(function(t){t&&(e.user=t)}),this.entities$=this.operatorService.entities$,this.loading$=this.operatorService.loading$,this.entities$.subscribe(function(t){return e.operators=t})}},{key:"presentAlert",value:function(e,t){return Object(d.a)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var o,r=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.alertController.create({header:"Delete",subHeader:"user with login: "+t,message:"Are you shure?",buttons:[{text:"Cancel",role:"cancel",handler:function(e){console.log("Confirm Cancel: blah")}},{text:"Okay",handler:function(){return r.remove(e)}}]});case 2:return o=n.sent,n.next=5,o.present();case 5:case"end":return n.stop()}},n,this)}))}},{key:"presentModal",value:function(e,t){return Object(d.a)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.modalController.create({component:e,componentProps:t});case 2:return o=n.sent,n.next=5,o.present();case 5:return n.next=7,o.onWillDismiss();case 7:return n.abrupt("return",n.sent);case 8:case"end":return n.stop()}},n,this)}))}},{key:"blockUser",value:function(e,t){this.operatorService.update({_id:e,blocked:t}).subscribe(function(e){return console.log("update result",e)},function(e){return console.log("update error",e)})}},{key:"update",value:function(e,t){return Object(d.a)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var o,r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.presentModal(m.a,{data:this.operatorService.formFieldOptions(t)});case 2:o=n.sent,(r=o.data)&&this.operatorService.update((i={_id:e},a=t,c=r,a in i?Object.defineProperty(i,a,{value:c,enumerable:!0,configurable:!0,writable:!0}):i[a]=c,i)).subscribe(function(e){return console.log("update result",e)},function(e){return console.log("update error",e)});case 5:case"end":return n.stop()}var i,a,c},n,this)}))}},{key:"add",value:function(){return Object(d.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.presentModal(L,{company:this.company});case 2:t=e.sent,(n=t.data)&&this.operatorService.add(n).subscribe(function(e){return console.log("add result",e)},function(e){return console.log("add error",e)});case 5:case"end":return e.stop()}},e,this)}))}},{key:"remove",value:function(e){return this.operatorService.delete(e)}}]),t}(),J.\u0275fac=function(e){return new(e||J)(v.Ib(F),v.Ib(O.i),v.Ib(l.R),v.Ib(l.a))},J.\u0275cmp=v.Cb({type:J,selectors:[["app-operator"]],decls:22,vars:5,consts:[[4,"ngIf"],["slot","end"],["contentId","main-content"],["size-md","8","offset-md","2"],[1,"ion-text-center"],[3,"click"],[4,"ngFor","ngForOf"],["size","4",1,"ion-no-padding"],["lines","none",1,"ion-no-padding"],["size","8",1,"ion-no-padding"],["color","primary"],["side","end"],["color","danger",3,"click"],["slot","icon-only","name","trash"]],template:function(e,t){1&e&&(v.Nb(0,"ion-header"),v.Nb(1,"ion-toolbar"),v.Nb(2,"ion-title"),v.lc(3,"Operator "),v.kc(4,P,2,0,"ng-container",0),v.Yb(5,"async"),v.Mb(),v.Nb(6,"ion-buttons",1),v.Jb(7,"ion-menu-button",2),v.Mb(),v.Mb(),v.Mb(),v.Nb(8,"ion-content"),v.Nb(9,"ion-grid"),v.Nb(10,"ion-row"),v.Nb(11,"ion-col",3),v.Nb(12,"h2",4),v.lc(13),v.Mb(),v.Nb(14,"ion-list"),v.Nb(15,"ion-list-header"),v.Nb(16,"ion-label"),v.Nb(17,"h2"),v.lc(18,"Users"),v.Mb(),v.Mb(),v.Nb(19,"ion-button",5),v.Vb("click",function(){return t.add()}),v.lc(20,"New operator"),v.Mb(),v.Mb(),v.kc(21,A,2,1,"ng-container",6),v.Mb(),v.Mb(),v.Mb(),v.Mb(),v.Mb()),2&e&&(v.yb(4),v.dc("ngIf",v.Zb(5,3,t.loading$)),v.yb(9),v.mc(null==t.company?null:t.company.companyName),v.yb(8),v.dc("ngForOf",t.operators))},directives:[l.p,l.O,l.N,b.n,l.f,l.A,l.m,l.o,l.G,l.l,l.x,l.y,l.w,l.e,b.m,l.v,l.s,l.M,l.C,l.u,l.t,l.q],pipes:[b.b],styles:[""]}),J)}],q=((E=function t(){e(this,t)}).\u0275mod=v.Gb({type:E}),E.\u0275inj=v.Fb({factory:function(e){return new(e||E)},imports:[[u.k.forChild(T)],u.k]}),E),z=a("FpXt"),V=((G=function t(){e(this,t)}).\u0275mod=v.Gb({type:G}),G.\u0275inj=v.Fb({factory:function(e){return new(e||G)},imports:[[b.c,s.h,l.P,s.n,q,z.a]]}),G)}}])}();