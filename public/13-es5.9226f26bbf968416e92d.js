!function(){function e(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,o){if(!e)return;if("string"==typeof e)return n(e,o);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return n(e,o)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,n){(null==n||n>e.length)&&(n=e.length);for(var o=0,t=new Array(n);o<n;o++)t[o]=e[o];return t}function o(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function t(e,n){for(var o=0;o<n.length;o++){var t=n[o];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{nhAk:function(n,i,r){"use strict";r.r(i),r.d(i,"ManagementPageModule",function(){return $});var b=r("ofXK"),a=r("3Pt+"),c=r("TEn/"),l=r("tyNb"),s=r("mrSG"),u=r("IjAw"),d=r("zHMj"),f=r("EhJz"),m=r("dndX"),M=r("lJxs"),g=r("tJKL"),p=r("4dfA"),h=r("mgGq"),N=r("AytR"),y=r("fXoL"),v=r("mrZj"),k=r("l7P3");function w(e,n){if(1&e&&(y.Nb(0,"ion-select-option",14),y.mc(1),y.Mb()),2&e){var o=n.$implicit;y.dc("value",o.key),y.yb(1),y.oc(" ",o.value," ")}}function S(e,n){if(1&e&&(y.Nb(0,"ion-select-option",14),y.mc(1),y.Mb()),2&e){var o=n.$implicit;y.dc("value",o.key),y.yb(1),y.oc(" ",o.value," ")}}function O(e,n){if(1&e&&(y.Nb(0,"ion-select-option",14),y.mc(1),y.Mb()),2&e){var o=n.$implicit;y.dc("value",o),y.yb(1),y.oc("",o.name," ")}}function C(e,n){if(1&e&&(y.Nb(0,"ion-select-option",14),y.mc(1),y.Mb()),2&e){var o=n.$implicit;y.dc("value",o.key),y.yb(1),y.oc(" ",o.value," ")}}function x(e,n){if(1&e&&(y.Nb(0,"ion-select-option",14),y.mc(1),y.Mb()),2&e){var o=n.$implicit;y.dc("value",o.key),y.yb(1),y.oc("",o.value," ")}}function D(e,n){if(1&e){var o=y.Ob();y.Nb(0,"ion-item-options",19),y.Nb(1,"ion-item-option",20),y.Vb("click",function(){y.ic(o);var e=y.Xb().$implicit;return y.Xb().presentAlert(e._id)}),y.Jb(2,"ion-icon",21),y.Mb(),y.Mb()}}function F(e,n){if(1&e){var o=y.Ob();y.Nb(0,"ion-item-options",22),y.Nb(1,"ion-item-option",23),y.Vb("click",function(){y.ic(o);var e=y.Xb().$implicit;return y.Xb().update(e._id)}),y.Jb(2,"ion-icon",24),y.Mb(),y.Mb()}}function j(e,n){if(1&e){var o=y.Ob();y.Lb(0),y.Nb(1,"ion-item-sliding"),y.Nb(2,"ion-item",15),y.Nb(3,"ion-label"),y.Nb(4,"ion-row"),y.Nb(5,"ion-col",9),y.Nb(6,"ion-item",10),y.Nb(7,"ion-label",11),y.Nb(8,"ion-button",16),y.Vb("click",function(){y.ic(o);var e=n.$implicit;return y.Xb().viewBooking(e._id)}),y.mc(9),y.Mb(),y.Mb(),y.Mb(),y.Mb(),y.Nb(10,"ion-col",9),y.Nb(11,"ion-item",10),y.Nb(12,"ion-label",11),y.mc(13),y.Yb(14,"date"),y.Mb(),y.Mb(),y.Mb(),y.Nb(15,"ion-col",9),y.Nb(16,"ion-item",10),y.Nb(17,"ion-label",11),y.mc(18),y.Yb(19,"date"),y.Mb(),y.Mb(),y.Mb(),y.Nb(20,"ion-col",9),y.Nb(21,"ion-item",10),y.Nb(22,"ion-label",11),y.Nb(23,"ion-text",12),y.mc(24),y.Mb(),y.Mb(),y.Mb(),y.Mb(),y.Mb(),y.Mb(),y.Mb(),y.lc(25,D,3,0,"ion-item-options",17),y.lc(26,F,3,0,"ion-item-options",18),y.Mb(),y.Kb()}if(2&e){var t=n.$implicit,i=y.Xb();y.yb(8),y.dc("ngClass","status-color_"+t.bookingStep),y.yb(1),y.nc(t.bookingStep),y.yb(4),y.oc(" ",y.ac(14,7,t.dates.from,"dd MMM")," "),y.yb(5),y.oc(" ",y.ac(19,10,t.dates.to,"dd MMM")," "),y.yb(6),y.oc(" ",t.price," "),y.yb(1),y.dc("ngIf",!(null!=i.user&&i.user.blocked)),y.yb(1),y.dc("ngIf","cancelled"!==t.bookingStep&&!(null!=i.user&&i.user.blocked))}}var A,I,Y,E=[{path:"",component:(A=function(){function n(e,t,i,r){o(this,n),this.sheduleService=e,this.store=t,this.router=i,this.alertController=r,this.bookingSteps=N.a.bookingStepsMap,this.bookingStep="cancelled",this.bookingStepExprs=N.a.bookingStepExprsMap,this.bookingStepExpr="$eq",this.sortFields=N.a.sortFieldsMap,this.sortField="dates.from",this.sortOrders=N.a.sortOrdersMap,this.sortOrder=1,this.date=this.sheduleService.convertDateToShort(new Date),this.maxDate=this.sheduleService.convertDateToShort(u.a(new Date,{years:1}))}var i,r,b;return i=n,(r=[{key:"ngOnInit",value:function(){var n=this;this.store.select(h.a).subscribe(function(o){n.rooms=e(o.rooms),n.rooms.unshift({_id:null,name:"All"}),console.log("rooms",n.rooms),n.room=n.rooms[0]},function(e){return console.log("load rooms err",e)}),this.store.select(h.b).subscribe(function(e){return n.user=e}),this.store.select(g.a).subscribe(function(e){n.bookings=e})}},{key:"ionViewWillEnter",value:function(){var e=this.createBookingQuery();this.store.dispatch(new p.a(e))}},{key:"presentAlert",value:function(e){return Object(s.a)(this,void 0,void 0,regeneratorRuntime.mark(function n(){var o,t=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.alertController.create({header:"Delete reservation",subHeader:"Reservation will be deleted",message:"Are you shure?",buttons:[{text:"Cancel",role:"cancel",handler:function(e){}},{text:"Ok",handler:function(){t.delete(e);var n=t.createBookingQuery();t.store.dispatch(new p.a(n))}}]});case 2:return o=n.sent,n.next=5,o.present();case 5:case"end":return n.stop()}},n,this)}))}},{key:"createBookingQuery",value:function(){return{dateRangeLimits:this.sheduleService.createDateRangeLimits(this.sheduleService.convertISOToDate(this.date)),room_id:this.room._id,bookingStep:this.bookingStep?{val:this.bookingStep,expr:this.bookingStepExpr}:null,sort:{field:this.sortField,order:this.sortOrder}}}},{key:"filter",value:function(){var e=this.createBookingQuery();this.store.dispatch(new p.a(e))}},{key:"getBookings",value:function(e,n){return this.store.select(g.a).pipe(Object(M.a)(function(o){return o.filter(function(n){return n.room_id===e}).map(function(e){return d.a(new Date(n),new Date(e.dates.from))?Object.assign(Object.assign({},e),{info:"start"}):d.a(new Date(n),new Date(e.dates.to))?Object.assign(Object.assign({},e),{info:"end"}):f.a(new Date(n),new Date(e.dates.from))&&m.a(new Date(n),new Date(e.dates.to))?Object.assign(Object.assign({},e),{info:"ahead"}):void 0}).filter(function(e){return e}).sort(function(e,n){return new Date(e.dates.from).getTime()-new Date(n.dates.from).getTime()}).map(function(e){return e})}))}},{key:"viewBooking",value:function(e){this.router.navigate(["/","shedule","edit",e])}},{key:"delete",value:function(e){this.sheduleService.deleteBooking(e).subscribe(function(e){return e},function(e){return console.log("err delete",e)})}},{key:"update",value:function(e){this.router.navigateByUrl("/shedule/edit/"+e)}}])&&t(i.prototype,r),b&&t(i,b),n}(),A.\u0275fac=function(e){return new(e||A)(y.Ib(v.a),y.Ib(k.i),y.Ib(l.g),y.Ib(c.a))},A.\u0275cmp=y.Cb({type:A,selectors:[["app-management"]],decls:81,vars:22,consts:[["slot","end"],["contentId","analytics-content"],["size-md","8","offset-md","2"],["color","primary","lines","none"],["pickerFormat","MMMM-YYYY","displayFormat","MMMM YYYY","placeholder","Select Month",3,"max","ngModel","ngModelChange","ionChange"],["placeholder","Select One",3,"ngModel","ngModelChange","ionChange"],[3,"value",4,"ngFor","ngForOf"],["placeholder","Select One",3,"ngModel","disabled","ngModelChange","ionChange"],[1,"ion-no-padding"],["size","3",1,"ion-no-padding"],["lines","none",1,"ion-no-padding"],[1,"ion-text-center"],["color","tertiary"],[4,"ngFor","ngForOf"],[3,"value"],["lines","none"],["fill","clear",3,"ngClass","click"],["side","end",4,"ngIf"],["side","start",4,"ngIf"],["side","end"],["color","danger",3,"click"],["slot","icon-only","name","trash"],["side","start"],["color","primary",3,"click"],["slot","icon-only","name","pencil-outline"]],template:function(e,n){1&e&&(y.Nb(0,"ion-header"),y.Nb(1,"ion-toolbar"),y.Nb(2,"ion-title"),y.mc(3,"Management"),y.Mb(),y.Nb(4,"ion-buttons",0),y.Jb(5,"ion-menu-button",1),y.Mb(),y.Mb(),y.Nb(6,"ion-toolbar"),y.Nb(7,"ion-grid"),y.Nb(8,"ion-row"),y.Nb(9,"ion-col",2),y.Nb(10,"ion-item",3),y.Nb(11,"ion-label"),y.Nb(12,"ion-row"),y.Nb(13,"ion-col"),y.Nb(14,"ion-item"),y.Nb(15,"ion-label"),y.mc(16,"Choose period"),y.Mb(),y.Nb(17,"ion-datetime",4),y.Vb("ngModelChange",function(e){return n.date=e})("ionChange",function(){return n.filter()}),y.Mb(),y.Mb(),y.Mb(),y.Nb(18,"ion-col"),y.Nb(19,"ion-item"),y.Nb(20,"ion-label"),y.mc(21,"Sort"),y.Mb(),y.Nb(22,"ion-select",5),y.Vb("ngModelChange",function(e){return n.sortField=e})("ionChange",function(){return n.filter()}),y.lc(23,w,2,2,"ion-select-option",6),y.Yb(24,"keyvalue"),y.Mb(),y.Mb(),y.Mb(),y.Nb(25,"ion-col"),y.Nb(26,"ion-item"),y.Nb(27,"ion-label"),y.mc(28,"Sort order"),y.Mb(),y.Nb(29,"ion-select",5),y.Vb("ngModelChange",function(e){return n.sortOrder=e})("ionChange",function(){return n.filter()}),y.lc(30,S,2,2,"ion-select-option",6),y.Yb(31,"keyvalue"),y.Mb(),y.Mb(),y.Mb(),y.Mb(),y.Nb(32,"ion-row"),y.Nb(33,"ion-col"),y.Nb(34,"ion-item"),y.Nb(35,"ion-label"),y.mc(36,"Room"),y.Mb(),y.Nb(37,"ion-select",5),y.Vb("ngModelChange",function(e){return n.room=e})("ionChange",function(){return n.filter()}),y.lc(38,O,2,2,"ion-select-option",6),y.Mb(),y.Mb(),y.Mb(),y.Nb(39,"ion-col"),y.Nb(40,"ion-item"),y.Nb(41,"ion-label"),y.mc(42,"Booking Step"),y.Mb(),y.Nb(43,"ion-select",5),y.Vb("ngModelChange",function(e){return n.bookingStep=e})("ionChange",function(){return n.filter()}),y.lc(44,C,2,2,"ion-select-option",6),y.Yb(45,"keyvalue"),y.Mb(),y.Mb(),y.Mb(),y.Nb(46,"ion-col"),y.Nb(47,"ion-item"),y.Nb(48,"ion-label"),y.mc(49,"Booking Step Equals"),y.Mb(),y.Nb(50,"ion-select",7),y.Vb("ngModelChange",function(e){return n.bookingStepExpr=e})("ionChange",function(){return n.filter()}),y.lc(51,x,2,2,"ion-select-option",6),y.Yb(52,"keyvalue"),y.Mb(),y.Mb(),y.Mb(),y.Mb(),y.Mb(),y.Mb(),y.Mb(),y.Mb(),y.Mb(),y.Mb(),y.Mb(),y.Nb(53,"ion-content"),y.Nb(54,"ion-grid"),y.Nb(55,"ion-row"),y.Nb(56,"ion-col",2),y.Nb(57,"ion-list"),y.Nb(58,"ion-list-header",8),y.Nb(59,"ion-label"),y.Nb(60,"ion-item"),y.Nb(61,"ion-label"),y.Nb(62,"ion-row"),y.Nb(63,"ion-col",9),y.Nb(64,"ion-item",10),y.Nb(65,"ion-label",11),y.mc(66," Step "),y.Mb(),y.Mb(),y.Mb(),y.Nb(67,"ion-col",9),y.Nb(68,"ion-item",10),y.Nb(69,"ion-label",11),y.mc(70," Date form "),y.Mb(),y.Mb(),y.Mb(),y.Nb(71,"ion-col",9),y.Nb(72,"ion-item",10),y.Nb(73,"ion-label",11),y.mc(74," Date to "),y.Mb(),y.Mb(),y.Mb(),y.Nb(75,"ion-col",9),y.Nb(76,"ion-item",10),y.Nb(77,"ion-label",11),y.Nb(78,"ion-text",12),y.mc(79," Price "),y.Mb(),y.Mb(),y.Mb(),y.Mb(),y.Mb(),y.Mb(),y.Mb(),y.Mb(),y.Mb(),y.lc(80,j,27,13,"ng-container",13),y.Mb(),y.Mb(),y.Mb(),y.Mb(),y.Mb()),2&e&&(y.yb(17),y.dc("max",n.maxDate)("ngModel",n.date),y.yb(5),y.dc("ngModel",n.sortField),y.yb(1),y.dc("ngForOf",y.Zb(24,14,n.sortFields)),y.yb(6),y.dc("ngModel",n.sortOrder),y.yb(1),y.dc("ngForOf",y.Zb(31,16,n.sortOrders)),y.yb(7),y.dc("ngModel",n.room),y.yb(1),y.dc("ngForOf",n.rooms),y.yb(5),y.dc("ngModel",n.bookingStep),y.yb(1),y.dc("ngForOf",y.Zb(45,18,n.bookingSteps)),y.yb(6),y.dc("ngModel",n.bookingStepExpr)("disabled",!n.bookingStep),y.yb(1),y.dc("ngForOf",y.Zb(52,20,n.bookingStepExprs)),y.yb(29),y.dc("ngForOf",n.bookings))},directives:[c.q,c.S,c.Q,c.g,c.D,c.p,c.J,c.m,c.t,c.z,c.o,c.ab,a.k,a.m,c.K,b.m,c.n,c.A,c.B,c.P,c.L,c.y,c.f,b.l,b.n,c.x,c.w,c.r],pipes:[b.h,b.e],styles:["ion-label[_ngcontent-%COMP%]{margin:0}"]}),A)}],B=((Y=function e(){o(this,e)}).\u0275mod=y.Gb({type:Y}),Y.\u0275inj=y.Fb({factory:function(e){return new(e||Y)},imports:[[l.k.forChild(E)],l.k]}),Y),$=((I=function e(){o(this,e)}).\u0275mod=y.Gb({type:I}),I.\u0275inj=y.Fb({factory:function(e){return new(e||I)},imports:[[b.c,a.h,a.n,c.T,B]]}),I)}}])}();